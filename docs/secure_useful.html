<!doctype html>
<html class="staticrypt-html">
<head>
    <meta charset="utf-8">
    <title>Protected Page</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- do not cache this page -->
    <meta http-equiv="cache-control" content="max-age=0"/>
    <meta http-equiv="cache-control" content="no-cache"/>
    <meta http-equiv="expires" content="0"/>
    <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT"/>
    <meta http-equiv="pragma" content="no-cache"/>

    <style>
        .staticrypt-hr {
            margin-top: 20px;
            margin-bottom: 20px;
            border: 0;
            border-top: 1px solid #eee;
        }

        .staticrypt-page {
            width: 360px;
            padding: 8% 0 0;
            margin: auto;
            box-sizing: border-box;
        }

        .staticrypt-form {
            position: relative;
            z-index: 1;
            background: #FFFFFF;
            max-width: 360px;
            margin: 0 auto 100px;
            padding: 45px;
            text-align: center;
            box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
        }

        .staticrypt-form input[type="password"] {
            outline: 0;
            background: #f2f2f2;
            width: 100%;
            border: 0;
            margin: 0 0 15px;
            padding: 15px;
            box-sizing: border-box;
            font-size: 14px;
        }

        .staticrypt-form .staticrypt-decrypt-button {
            text-transform: uppercase;
            outline: 0;
            background: #4CAF50;
            width: 100%;
            border: 0;
            padding: 15px;
            color: #FFFFFF;
            font-size: 14px;
            cursor: pointer;
        }

        .staticrypt-form .staticrypt-decrypt-button:hover, .staticrypt-form .staticrypt-decrypt-button:active, .staticrypt-form .staticrypt-decrypt-button:focus {
            background: #43A047;
        }

        .staticrypt-html {
            height: 100%;
        }

        .staticrypt-body {
            height: 100%;
            margin: 0;
        }

        .staticrypt-content {
            height: 100%;
            margin-bottom: 1em;
            background: #76b852; /* fallback for old browsers */
            background: -webkit-linear-gradient(right, #76b852, #8DC26F);
            background: -moz-linear-gradient(right, #76b852, #8DC26F);
            background: -o-linear-gradient(right, #76b852, #8DC26F);
            background: linear-gradient(to left, #76b852, #8DC26F);
            font-family: "Arial", sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        .staticrypt-instructions {
            margin-top: -1em;
            margin-bottom: 1em;
        }

        .staticrypt-title {
            font-size: 1.5em;
        }

        label.staticrypt-remember {
            display: flex;
            align-items: center;
            margin-bottom: 1em;
        }

        .staticrypt-remember input[type=checkbox] {
            transform: scale(1.5);
            margin-right: 1em;
        }

        .hidden {
            display: none !important;
        }

        .staticrypt-spinner-container {
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .staticrypt-spinner {
            display: inline-block;
            width: 2rem;
            height: 2rem;
            vertical-align: text-bottom;
            border: 0.25em solid gray;
            border-right-color: transparent;
            border-radius: 50%;
            -webkit-animation: spinner-border .75s linear infinite;
            animation: spinner-border .75s linear infinite;
            animation-duration: 0.75s;
            animation-timing-function: linear;
            animation-delay: 0s;
            animation-iteration-count: infinite;
            animation-direction: normal;
            animation-fill-mode: none;
            animation-play-state: running;
            animation-name: spinner-border;
        }

        @keyframes spinner-border {
            100% {
                transform: rotate(360deg);
            }
        }
    </style>
</head>

<body class="staticrypt-body">

<div id="staticrypt_loading" class="staticrypt-spinner-container">
    <div class="staticrypt-spinner"></div>
</div>

<div id="staticrypt_content" class="staticrypt-content hidden">
    <div class="staticrypt-page">
        <div class="staticrypt-form">
            <div class="staticrypt-instructions">
                <p class="staticrypt-title">Protected Page</p>
                <p></p>
            </div>

            <hr class="staticrypt-hr">

            <form id="staticrypt-form" action="#" method="post">
                <input id="staticrypt-password"
                       type="password"
                       name="password"
                       placeholder="Password"
                       autofocus/>

                <label id="staticrypt-remember-label" class="staticrypt-remember hidden">
                    <input id="staticrypt-remember"
                           type="checkbox"
                           name="remember"/>
                    Remember me
                </label>

                <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT"/>
            </form>
        </div>

    </div>
</div>




<script>
    // do not remove this comment, it is used to detect the version of the script
    // STATICRYPT_VERSION: async

    const cryptoEngine = ((function(){
  const exports = {};
  const { subtle } = crypto;

const IV_BITS = 16 * 8;
const HEX_BITS = 4;
const ENCRYPTION_ALGO = "AES-CBC";

/**
 * Translates between utf8 encoded hexadecimal strings
 * and Uint8Array bytes.
 *
 * Mirrors the API of CryptoJS.enc.Hex
 */
const HexEncoder = {
    /**
     * hex string -> bytes
     * @param {string} hexString
     * @returns {Uint8Array}
     */
    parse: function (hexString) {
        if (hexString.length % 2 !== 0) throw "Invalid hexString";
        const arrayBuffer = new Uint8Array(hexString.length / 2);

        for (let i = 0; i < hexString.length; i += 2) {
            const byteValue = parseInt(hexString.substring(i, i + 2), 16);
            if (isNaN(byteValue)) {
                throw "Invalid hexString";
            }
            arrayBuffer[i / 2] = byteValue;
        }
        return arrayBuffer;
    },

    /**
     * bytes -> hex string
     * @param {Uint8Array} bytes
     * @returns {string}
     */
    stringify: function (bytes) {
        const hexBytes = [];

        for (let i = 0; i < bytes.length; ++i) {
            let byteString = bytes[i].toString(16);
            if (byteString.length < 2) {
                byteString = "0" + byteString;
            }
            hexBytes.push(byteString);
        }
        return hexBytes.join("");
    },
};

/**
 * Translates between utf8 strings and Uint8Array bytes.
 */
const UTF8Encoder = {
    parse: function (str) {
        return new TextEncoder().encode(str);
    },

    stringify: function (bytes) {
        return new TextDecoder().decode(bytes);
    },
};

/**
 * Salt and encrypt a msg with a password.
 */
async function encrypt(msg, hashedPassphrase) {
    // Must be 16 bytes, unpredictable, and preferably cryptographically random. However, it need not be secret.
    // https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto/encrypt#parameters
    const iv = crypto.getRandomValues(new Uint8Array(IV_BITS / 8));

    const key = await subtle.importKey(
        "raw",
        HexEncoder.parse(hashedPassphrase),
        ENCRYPTION_ALGO,
        false,
        ["encrypt"]
    );

    const encrypted = await subtle.encrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        UTF8Encoder.parse(msg)
    );

    // iv will be 32 hex characters, we prepend it to the ciphertext for use in decryption
    return HexEncoder.stringify(iv) + HexEncoder.stringify(new Uint8Array(encrypted));
}
exports.encrypt = encrypt;

/**
 * Decrypt a salted msg using a password.
 *
 * @param {string} encryptedMsg
 * @param {string} hashedPassphrase
 * @returns {Promise<string>}
 */
async function decrypt(encryptedMsg, hashedPassphrase) {
    const ivLength = IV_BITS / HEX_BITS;
    const iv = HexEncoder.parse(encryptedMsg.substring(0, ivLength));
    const encrypted = encryptedMsg.substring(ivLength);

    const key = await subtle.importKey(
        "raw",
        HexEncoder.parse(hashedPassphrase),
        ENCRYPTION_ALGO,
        false,
        ["decrypt"]
    );

    const outBuffer = await subtle.decrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        HexEncoder.parse(encrypted)
    );

    return UTF8Encoder.stringify(new Uint8Array(outBuffer));
}
exports.decrypt = decrypt;

/**
 * Salt and hash the passphrase so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} passphrase
 * @param {string} salt
 * @returns {Promise<string>}
 */
async function hashPassphrase(passphrase, salt) {
    // we hash the passphrase in multiple steps, each adding more iterations. This is because we used to allow less
    // iterations, so for backward compatibility reasons, we need to support going from that to more iterations.
    let hashedPassphrase = await hashLegacyRound(passphrase, salt);

    hashedPassphrase = await hashSecondRound(hashedPassphrase, salt);

    return hashThirdRound(hashedPassphrase, salt);
}
exports.hashPassphrase = hashPassphrase;

/**
 * This hashes the passphrase with 1k iterations. This is a low number, we need this function to support backwards
 * compatibility.
 *
 * @param {string} passphrase
 * @param {string} salt
 * @returns {Promise<string>}
 */
function hashLegacyRound(passphrase, salt) {
    return pbkdf2(passphrase, salt, 1000, "SHA-1");
}
exports.hashLegacyRound = hashLegacyRound;

/**
 * Add a second round of iterations. This is because we used to use 1k, so for backwards compatibility with
 * remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassphrase
 * @param salt
 * @returns {Promise<string>}
 */
function hashSecondRound(hashedPassphrase, salt) {
    return pbkdf2(hashedPassphrase, salt, 14000, "SHA-256");
}
exports.hashSecondRound = hashSecondRound;

/**
 * Add a third round of iterations to bring total number to 600k. This is because we used to use 1k, then 15k, so for
 * backwards compatibility with remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassphrase
 * @param salt
 * @returns {Promise<string>}
 */
function hashThirdRound(hashedPassphrase, salt) {
    return pbkdf2(hashedPassphrase, salt, 585000, "SHA-256");
}
exports.hashThirdRound = hashThirdRound;

/**
 * Salt and hash the passphrase so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} passphrase
 * @param {string} salt
 * @param {int} iterations
 * @param {string} hashAlgorithm
 * @returns {Promise<string>}
 */
async function pbkdf2(passphrase, salt, iterations, hashAlgorithm) {
    const key = await subtle.importKey(
        "raw",
        UTF8Encoder.parse(passphrase),
        "PBKDF2",
        false,
        ["deriveBits"]
    );

    const keyBytes = await subtle.deriveBits(
        {
            name: "PBKDF2",
            hash: hashAlgorithm,
            iterations,
            salt: UTF8Encoder.parse(salt),
        },
        key,
        256
    );

    return HexEncoder.stringify(new Uint8Array(keyBytes));
}

function generateRandomSalt() {
    const bytes = crypto.getRandomValues(new Uint8Array(128 / 8));

    return HexEncoder.stringify(new Uint8Array(bytes));
}
exports.generateRandomSalt = generateRandomSalt;

async function signMessage(hashedPassphrase, message) {
    const key = await subtle.importKey(
        "raw",
        HexEncoder.parse(hashedPassphrase),
        {
            name: "HMAC",
            hash: "SHA-256",
        },
        false,
        ["sign"]
    );
    const signature = await subtle.sign("HMAC", key, UTF8Encoder.parse(message));

    return HexEncoder.stringify(new Uint8Array(signature));
}
exports.signMessage = signMessage;


function getRandomAlphanum() {
    const possibleCharacters = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";

    let byteArray;
    let parsedInt;

    // Keep generating new random bytes until we get a value that falls
    // within a range that can be evenly divided by possibleCharacters.length
    do {
        byteArray = crypto.getRandomValues(new Uint8Array(1));
        // extract the lowest byte to get an int from 0 to 255 (probably unnecessary, since we're only generating 1 byte)
        parsedInt = byteArray[0] & 0xff;
    } while (parsedInt >= 256 - (256 % possibleCharacters.length));

    // Take the modulo of the parsed integer to get a random number between 0 and totalLength - 1
    const randomIndex = parsedInt % possibleCharacters.length;

    return possibleCharacters[randomIndex];
}

/**
 * Generate a random string of a given length.
 *
 * @param {int} length
 * @returns {string}
 */
function generateRandomString(length) {
    let randomString = '';

    for (let i = 0; i < length; i++) {
        randomString += getRandomAlphanum();
    }

    return randomString;
}
exports.generateRandomString = generateRandomString;


  return exports;
})())
    const codec = ((function(){
  const exports = {};
  /**
 * Initialize the codec with the provided cryptoEngine - this return functions to encode and decode messages.
 *
 * @param cryptoEngine - the engine to use for encryption / decryption
 */
function init(cryptoEngine) {
  const exports = {};

  /**
   * Top-level function for encoding a message.
   * Includes password hashing, encryption, and signing.
   *
   * @param {string} msg
   * @param {string} password
   * @param {string} salt
   *
   * @returns {string} The encoded text
   */
  async function encode(msg, password, salt) {
    const hashedPassphrase = await cryptoEngine.hashPassphrase(password, salt);


    const encrypted = await cryptoEngine.encrypt(msg, hashedPassphrase);
    // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
    // it in localStorage safely, we don't use the clear text password)
    const hmac = await cryptoEngine.signMessage(hashedPassphrase, encrypted);

    return hmac + encrypted;
  }
  exports.encode = encode;

  /**
   * Top-level function for decoding a message.
   * Includes signature check and decryption.
   *
   * @param {string} signedMsg
   * @param {string} hashedPassphrase
   * @param {string} salt
   * @param {int} backwardCompatibleAttempt
   * @param {string} originalPassphrase
   *
   * @returns {Object} {success: true, decoded: string} | {success: false, message: string}
   */
  async function decode(
      signedMsg,
      hashedPassphrase,
      salt,
      backwardCompatibleAttempt = 0,
      originalPassphrase = ''
  ) {
    const encryptedHMAC = signedMsg.substring(0, 64);
    const encryptedMsg = signedMsg.substring(64);
    const decryptedHMAC = await cryptoEngine.signMessage(hashedPassphrase, encryptedMsg);

    if (decryptedHMAC !== encryptedHMAC) {
      // we have been raising the number of iterations in the hashing algorithm multiple times, so to support the old
      // remember-me/autodecrypt links we need to try bringing the old hashes up to speed.
      originalPassphrase = originalPassphrase || hashedPassphrase;
      if (backwardCompatibleAttempt === 0) {
        const updatedHashedPassphrase = await cryptoEngine.hashThirdRound(originalPassphrase, salt);

        return decode(signedMsg, updatedHashedPassphrase, salt, backwardCompatibleAttempt + 1, originalPassphrase);
      }
      if (backwardCompatibleAttempt === 1) {
        let updatedHashedPassphrase = await cryptoEngine.hashSecondRound(originalPassphrase, salt);
        updatedHashedPassphrase = await cryptoEngine.hashThirdRound(updatedHashedPassphrase, salt);

        return decode(signedMsg, updatedHashedPassphrase, salt, backwardCompatibleAttempt + 1, originalPassphrase);
      }

      return { success: false, message: "Signature mismatch" };
    }

    return {
      success: true,
      decoded: await cryptoEngine.decrypt(encryptedMsg, hashedPassphrase),
    };
  }
  exports.decode = decode;

  return exports;
}
exports.init = init;

  return exports;
})())
    const decode = codec.init(cryptoEngine).decode;

    // variables to be filled when generating the file
    const encryptedMsg = '086fede0958091fddf419ea700527bd35d89a19ce3e181b9cfbf93538e2eda3cf22e96b66cef4203f2c60c6428eb96c98980052bf072e34a91c4153674deae8c63d3f39229e97b96ed67dfa03556a1469f02b9949d87a98eae00c569c020a522a9e69062d69fdf3e46c84f8c86e6820c152c505ab3744f02b30b8be68a9a027e76ebb578956b2b51b6371a2d255502fabb4b069d9c97fda5fbfe07e5ef7b372244191051084f6e231be47ef1a870b68fa7bc58c9c480ed823d375cb44bacd7f5e02b6fce814041610310f6a16cf5567febed574c7408b9d46f9c21b06517f980c28867f7f37eecfde059494b7e01341575db49655cc0c64468dad712a1f18a1b47825121ec4a789fc9a35072a02e262fb2dd09ab338f3ae9b03127bcadd71b15c7f56e059507bdcc3f50ce075ca70370ddf1c267e524bd8dd64724b262c503dd9ccddced05beed7450346958b2d1e784c4e117df37e482454e7cceb7142354efed122a49a2ea42f706e16f90d7e13721c2d4c1921d32325619e800e90a5cb2cdd74ce4826792fd1b2797d64c907a5235e5155b9a0fec8e007d9580bada6c2ee1ec7a46f51fe7200654d310da040800d390e75d8d5b3ca17b17c28185a3ffb53d094c93a3f55b8034206f11e0167fd23e81e3d1fcd1f5dee185ac1dd1464062044ad4bd88b3904a837f3e7782fa919a9d056e71566479993b6140f1a6f7281f429e358ad4a84101b0e9954a306447b0ec26340c88c472f9fa68f47b7800e37639be2f78d561289ac4c8ade07c931ecad61cd45a2586ced71ed1507ae506e8c724b32860d77d3a2debb77c70cd1e6be16611cdba0c3f08b2d2200c5d6d47dfe2c14db23b508e44316473cb3a29a0b93bc2b37fbf3d617dcc49585c706f3a3a4ad0a0f0c15f9bf995dc230aee009f7ebca3e88b09c830cb48d11d7730732d00624263c891c9361066374d2e66df188cab1195b0a0c3537a1d3cdcebca00101ff626a045543a455d73e7939dc15d145524bbec4d0f2abb49f52b9cecef9d75adfb8097c12ba95225a698c62930d1f712f248593a582ceb16b1f34fa45f8313e6a713499d778caeeb9d6c279165cfba9b312a3822d70274c552cfa46056b1044c4522cf44872276b8837d1f7a3daeaaf2564c06170d55e5089f899e07c959fdc801a547477e084c52fc08b08b275e8ad408910b7aab52f50f87aea36e3d3f22bf62f52d8f7c96ffe220b3d27e57beb3ef5413482986738e03ba5781b8c121210d54610323e723c20019fef00c2ce345e6b5e9c97c8b57dd61388f0a47eea218a1511c4c201caa53a271d8972663b689ea5f61886faa81d907d7d97ccf05b46a2c233f1ec76cbb9c006bbd1431bfc35edd56794ee9192e753c9b9d894b07e9a1518dc4c5adbeb49b29910e33fb3742044e079e4557026ded50a969656891115a58b7dad827bacd8b314a287ac1d2fabb4754b101728030b7ecc3eda89764465e30106d013a9b92d04eddfc86bc5b9c44ead73d278a8dcf3adfc72b90f46c12f9f0ec2731107a4a2c2b6ce35fac4f9fe759b842a225ea66c31f47e1558729614b09e7134254b897f842d0f35279fc9c5d6919e008647fd1ae57fef18af2bb129e284e17693f13e7df7bcca45773256ace21d4f60e8e0712eba013c3dc85ce1de129ede100116493273a66b0858ef34457b3c73d56820a8965395f5a93e238122d99217ada0e9ad765236b0fe7a44ad21acc64ca6cd533eacadc6c75083858c39f11e68ab2b965b06763facf91b445293512a8aabc368fae462115dd9dedc1e0cb2754b9eb8031a08fcb20d93e00c73c330ec019d7587c5297e36aa006b6c735fb1d747cf9a3763bc842bedaa45d269db29d30b7967c66f4b3a356fed4e706bf98d9b88aafccb92661c495cc82d35ed68c4da34f1393730ce088a4a75484bbcf51900b875b1b3439d0a4fc2eebd2f8deaa00ad38948a37447f1b988e060d6a00cb44fe7189e8e893606f6b1b09db480904428d2d6f7caa047288c7b325ed00055fb8d95210020cac9d662b594427085bd1326100123385e1dfc8f5a64056e51fcd1271c108341b4ed418fb2925addb6301fa2565c5efce41f1cc89d75794e1fcd236a287154b922fc81082e3872d51a988ea1397cfc6d71b16217a8181fe95bc29299c5b862d0bf55209494ee81f99ff8a156493efaf7319e165db8f333d32e80f5ca45377decb078acf2e5f5145debfbdbe9625af1b6415287cd4aef4be5cd27b437445abbcf2409a5570fab7a177abf7f181b67e303b55db37e240e3be64a2acf305c7332b481adae33aff31d955ac4c43c9cc12385fa961fa29615e6e5eb3ac0a473876712b572b54dd41001edaa791a1abe2fd86c162ef5518c5429ec203687466d30a71fef58b8cdde5a98c5904806f8b88c39e9b250c04e29af20a7faa5413c3ed02363d2c1d709f85d676a57ee0601e7525a727e97841b53e043579068d3fb6713d27f43a19e74af70dda87a4f230a104d68a2da80269aa5c08f50835bc6b6bd702c57e10d869498710faebb73548bf71f52032f84cfc9ceed659a551764bacff9bb004fe368a5aef5d7b8419da88ab4119419846fbf130aa026dec1c0ab1ea9c115faebfc056e4bd69d98e18cf0dbfe0d70ef85bc68cfaffd57a6338613c921d8b989e71cf4e9f986d0d4b65c552da99e269c08d9eb6915db5be88c77fb4c59c8ebc92deb64465b1c64162ef265223884b080f88b230a371171162aca71dca9e630263cdb5fafffb7ef1463cef8eb31a409952e08720c83f9c7caab4d24ff1f6536e405c6cea219f51892574fb931d17f63c6af310a61783766314470d5866c83b168334ba906940e570cefa56d2e3aceb1511cd295374fd0e4f2b7fbc97db541afa5e7a572b5ac7fc3a0f2f5864dde8cb107c8903603a5c0c42a933ab225993af683bb939c189167fa3b663fb0d7d2bb3b2431cf14249f795980a8caf1a23472a4159d20a407762bda73a4ad64b9cbc519a34ba62d26b568e5f004e251c959e7ce373b051f2c0ebcd2c025917b9fb94043d551b05621f561ab4685622a03f0e4c4677e3481b8bbb45e2ca6b22a1d849c64cc7b613988ed0e53976625496ab3bf8c64eae90d83d9ec0d6bf0fa582bd750ea7eac0f18a720815c0a95cc445bcf839e3dfc2857b7e1a04750a2889f7027d98bc7ad6af3a46a5f0cdd52401ea10d64a54565a01f4b26d020f11ed7e083a00eada11d38d0bb7267f769d9fe97f8fad40445b64d1b6f80823db8f20ac83590550e280df83b8a9797ae737d35ba2502a5cf160248b74b807cb4fed7c475bd9e8336712ab6acdef031282a8c2f68503aee955d3ede76cac1bf803d7bdd36e1e296908f862b5e92c7bf913ae5558c44a78309a6e4899a184264ee40e1fa3539e0daf6a40c92b04b06b543b3d7aeb9a5f03c59210c8692f8d848e9e1cb662b4f46bd8f4ba378147cae362ccd49ab2a480d6af53852c89ed5b0ca36ceb01a2df1f87c21897dd3260f7780bc19d0c760232bc76948173d08307f2d49d1c51b15bf05b7c11fdb13fdf464ee370bde0c8ea540ce3999a4959965be98343fc8e7e56fedb017c645e4a5fd9261866d9da04e087895d84aab36510152f99346bc103cdf26f7c7564cd25aaeab614493122391fb6b3dd0a766de744c510b6ca108902382e3aa597a5052014335c31785525f063f5da900aa521f60fe6ce956b8a66ed3ff69e19e4af193fa830718ed8b822517590ce59a48c579fdee26c293bb818bd211129c60a987ecc8cddb06d96c8448599aa407f730d27ce53eb7fa2c2ef895ab36ec47492e2b1890688a41937084460f1959b2943ebe306c7a5e65a9b01666d6d783d2eaffb101777f2696c5abc1c1e302d3933ec72221bd09f547c4aa3024faab50f9644f428da8cf1604f34f27b19e54c2aa52b3da7f5b8e579780309be82ca13d718390a2b77b33ee6bd1ea6597f110ae14496171edc29fea8e70138c07686f55ce73e6339db7a7be01b1a9f4799b76b2aa20cd38eaa116e980ea2d146b647392778cc2e133ff6c05331613501e5172451c4de30a675d83d6056e2b17bbd98002864055f45c0aeec801bea194c89b0b8b1fa998bef79473916ba589dd01b1d321678ce1bb3b717bb9a9fb34384b903016c65cd8374a113b72548aee786b5f41fd08433ecb4260668ed835ab158e18d33fec1d4700d6f547fd7db4166c9629eee46c1ad9e3e315c9cc0781fdddda3da78bc8d493ca4c7f93030dbab5b7f7b46e89e7318ac78ea2aecd51aa7c89b33e71d7f489f5576edf212321b9b18313e9470930abdd16f3f857eef71488d84b07e7546f0717ee632c1b06d242e1366989e59be3813beefd0b3baa460609a3b1d402046f34d1c350691c365a70fe1dbccbc911cc398df9ad1c355238aaaa583dd78c95d97b89866ddd98e6a8d2fb29fe8bbaa2f47af7b2082e78eefb09d2bb7987da45af5508c82a1ac5d74825dfcec785521f1b3f506332df24a3e07d3aa5491922a0f73eb19b245b36192214b368f071676b3e1b3ab771bb91aef2325d9465a14773d2e81f78017f28ecd59b00a725df01058c9144bd1b67044e158fb0b94a87d2bd19577683b80d0c8e48206b051fce84842ef829ccab2e63f2f814a34022bd6090c5c3deaf2313903f140b103ba03ecc8a904d78584079e0f667c4e7cd6c30b7675158022ef12f080ab395cf5addf4e81afdbe8135ff37d652c1e83bdafe16bd319d5e3236334109561da1143f30d6a98b6eac975350ee8258356f1d8447152c8bee422cde76a286c1958779739c1aba38de5b5e1ae803975a6f113413e1e95ee673005801e5bd047e23a2a98988d1249cef79154e3ab4e23044a1ba69252d6116f9c2c08ae470b9a8bfee8a79819c63ca258598623a64056d5b53564ce2afbd07a6ca9e0f72e0fda974cba3c2b3a7ecbdb9ba70ca5f294d1dc8f17d2ca8203b1c134d8597b7eb36c2c976db52bdc162150bb423dda2aa6854aa4b215cf844c3477e548bf624e2a96d78f8243de71dca8f665eb31a2a742260aeb9d72f42f5d5177796c6cdd24c586eaa03cf718be9ed0cbf20609709b0ae85fb399cd2deac0aa2eff126793b0983bb967ff6448dbe9d05657d4fca1b5b62a9b9f93d627bd311e9834e696592615f61e8b853d090588e6b615f87206b4e8877d14909c2d40d9539e5a6dc1d73cd9698867461869dd7cb164277771ab1883710bb353e652573bb5a1d95f8d4e19c6f923f2be65b1b72c7c9bbb63164cf816badb8ef83f8c3e99e2e887387d2ab61e4638fc1c16ca166948708fb5f8900553070a29984e201a8d9b0a82b1887cb85bce98fd3ea93276fbd3228848d8ad4afbc68f796b76495e7fa408a9cc5bec7592be840da784908da084b129bab9afd4a17826589047e2e8dcd215b4f211b2e18b798dade03c2dc8d34fb35f618c7507669a51effc6786d8246a2ab378aeeb467af6a45e43db173fb47d59ac40730ef7079d7a7d7f531ecd7a579621ea657f79f1c5ae5d046beb7e28084b3944a968e090703f8d65d4ed8db4dfad5cf4f437f7b49ab03eba2eb6617f2544539487428d73bb99ef4dc5ede4f6e2ea8f870a4a6674e1ebf449f5e056c5ac6c164f391a7a5c4c2adfafa462eea8a429cd32a42e32bb169491c66934bd9d906ea3b44a86e365c083572e65d4eed8909a87adf23bc3d339f363604ff2772519f2115055c43cc5e7635cc0e78038ef129eb6af137354cbc0b0b4e53596629986ed4cc729daff791d46949830ea00374fa4c7e52ae5e97ed1295d0a84715d6d2b87333900443063f0c0e8b7843499b63e92c19334cd38fa343c8a1119545e21919d51cdee69cb571e14a04457103fc82ccd755eb7ec40b7bc816922e833a434786d530140ee60b333e399165a2594b80966d258ff3fad55e29731d815b940ad090c5bf32c1186718dfc79aa387d2de0747ea16085be8b3e178a50ae59bca4b40a7a3436eb40fc697843c3fdf7abfb8e19e53b94870fbc451e58b0b4e3d68fb91e7f3ba17e1b4249367c169a69504fc345d31bf2c37a06be69ae304bdb267ff808459c75c9eb7cf9fa6aa020c7beb46dbbab291e594119f1d7fc78c811e8ef3e41f0096f59ba138c696cfce42392f24ce060788e429bdfb6e89fe88ee65e1ed82ffb7bf0865662d99ae2a04e204f4913a4e8379acd9aa83951996816304c7115fce921a8ae449068218bfdaff4a7413996b57f4531e8090edbab337142ce6c09d107452a59ab8e0f36193228884febf602fbfbd4d6ad5279f6c40c0e86dc662f50c616580cc87af4d8769d693bb3fd126c3ba89119d1e57b8206b0339db20585ff6c308e8d3f9b2175a05b0462d5e31de3c7b0d535f4bbb1f018f769881ef9c539ed5c137ab78b79031d9377f50f7dc6ff91b8b127d52f14975bca04001ed2975494a24b7b99915a05a4e0754cf6e66183444dad431389c8d65d32e32c5850384e375512172fd88896cedbd5a59fad6f18a5cffc5275c741f4858590cfc228255d39aa22e49903f3ec2f5bc219eab7862d341fad72fba14b2c05f7cad0b25eb6730abb7a3928dd98e93ef7cc612e1daa031e17e44a0933235a6198b1c69aec6668ebff3e97194873ff504290ff2c73212656eb5d56224bd92163e1affbe794b24f2f9c7aaafce3d152157557c13e66041102b7a150e5cc2c867fc3d430a606f8fe8707a5035e31af8895a5cc76e6367601c190032423a18122e1311042616b32b71db4281b3cc9e873a59b83b4e629e0108c16186767d0af7037b637debe8bf2115420f9a7ea9eab00cd55d8a80f786364e29660472ef26bf82fe9b67e918001cd598c04f70ac3a3e4c5007720c514ca8ecbebe5a23453f498e58c33237798c72c8ce4843a4ff16606506238fe1d3c66a1107f4f2d759cd49f9c6889f453f4071a6b360c35e03c0fd22ddb57c1381897186a740f5268e64c78d11ca04c0f2e6e2c2046d7979834a73a72cec58afa6b7f7b94ca1718026b47898a43c4359339bd3c860e798114e1adbfb5906bbd1bba0639fb0ce13a02e282ee9b90245241a739a4646012ab8d01f0f6765061f33ef5c2dc9c1777d09b7027c37001af5187d5ef6ec988fb94cb09b1dc1586ef0786ada797a77e6ee5864e98469bbeaca30d0b5ccfcc549d97be98278b2968b2a5e0fb33788485e0506a9ea30c0ef6a8088d37d33f00e5012f2a294db88913643792bba62d0a6160517aa8243c6cf52fd5d7454922d1d8d84640c72782b17acc3f0b2291a950222e0a07faad681c5d396ddc0c539ac6d030b056ff82ccce830bdeab1ceee7168fb3104ad3f54d2120ee292840eb336e157908e5e09828959c53425365baa38149f7e2e7d743bedb4f957700ec16ba1d9c3565607633a7cc60d549b4942e676bd5c33c001e752327a3ad40eebb7c98bd1a582ff713705cd2be66043aad42a9802219c493d6a7a97f820299083c84e8ea8264b729402ccacb1ad84310c0e9f21294954563faf1d1b4d52f9940a7bc6d9e5ccc24549b82e22ad14e8220f61aab45d6c0b71b74ee1d1768b02fa426f3b3ea00e0fc600d7f235a97dcfbb48892789b9462049b1bc171924721f7b26855704548cb4ed0738bd6d195a4f376582120bb02a6c9b5160ccc5aed01d47cb61903d0a9ad48f4f72ae11e3b99dcaea7596af704cc8cb6532ac370269920e407c5d9e655506ecf76faa74c742ff2dc90a8712a9e0dc8243c1e431395f16d88bb987c701e1050170a0ec37aeb66dccec94c64e4fb258939169b2e70664876787e22a58ce57384f676b5d22976a24a2698fc60962ea384155978625d4e8fc7722f388b6b8e222b0267fb3dea480c08cfb24ec44190090007f760c2a85db902e6f117132b98b82e3ca2439281499f3b0d02cf902c3ad3d01cc64faa94be2060c7d68e924307d5e0466a37b14d2008246e721a01b1df88f21e9e8b15454641bf6d34aa7e5e5a5678f618f36b49dec7941a8506c136a79f4ef5280048d9cba6f82c35ce3b3cb20cbee6f3d2b312a125d487f4c6852417b4c95b25d22c682ce3fcd8a1239adee405be6a7cc9023736a646ec914f89d0399c76d5f34fb572221700e2cb670267f26c04aa91f071b12be855477199c19cdbff3dfbbef525409dd347d41c913b26c2835bd60888453c0baa1f334ef395f7f5c2a6dc6ae6f4902a5a008f6d2f852a53e7f1622279dcc6af493b0e9675337361d22d55dc63579beb24fab649c86e32b36f701607ce44f4a155dcf438dc76d3e3d28886e983a61ad1a185e414ddf15166bcbf2d9021088f95d5a8b173c102c8f3a5908f5db6cc31192ffe2df80f5d1525e83dcfb512fb5fdcde53247f22bf1b99b5fabaadc358e4992953ac8907f216b8d13fca4bf7f15b7e03d74ba1774a592101c15f92b2dc49432335cbd9e052eba96511a735fa02735856cb5ff3fdbd2ea2aa0d77be2fb4557f0b14e16144ca70cc3851a95c07b7dfff5596587e24508b2c50d72033952978366c12f9c2304e0d74036f93874980365c9f3e4aed6f3deb39a688b2136d6353748cd8d344df4e80a1d5dcf10621674309d6f2da1428b088c22736b9bfb2b5b21959ff7d8925c93ec6d45db34aa2804735c80eee11b38999d6a04770e19a9080ae2278b564ff9f68f7234489583aec307ffae03095cf6d17f1a2c4b7c7c41f1e7ba4a3cd359cadbf4ce02ebc23a490c8d42e03010cc752d5b9a34d0d9f825f95098cc1859574f46681d08710fe6650091d023a10061651ad9330340c4209e5990ee19dee274979ee5eab1b693e7fc5e16f5105cd5e2f67cc87013bab38c7b665c008258018dffe6df400e6e1d21466709ab4ffd690882d00aee08db74382b307c68de86cd874377aabc762301f185fea39aea818ce4b2156f53f4bf2a9b8220d74f885f429839ecdbd1d743b4f6ac66cc7ebf158abcf459fb3136636bb7514fc6ce559c45a95b59250d8e7f1ea5115a9d5620fea1e2c2047c39c19b18ce174ac49c51aa8d88791c2c20698d80c4d46c37912bcebbcdfda1884fa64b387c8bf3321812a04597bae88382ebcfa61f2e4cf0af1026faa913993e5f150d27811d0b53e9535739a54d707f1f8c08a28b77b6047260eee34410a72f69b93dbbfb733b0f034686694eccba4b32596fa72e3b396d0850e2c5a5121d8a865fa68e8ee75b4d89985deaab9befdd96e53d25f2f20cca1c4aca1020371f289ea03752ebfec1d4376c84bf2c30c950ab89650e9e0a4dae62cef6da6261c439e9f4a98b0190f7f5c0ccd86af18a4bd57fc222600494b842f46e33aad68e51986412761407d3a8dea2be1f0df806543adfa4e6887e413e43101ca70ebc493481c5248c7d9a5187dcdada6b4c3be9f02764cae14f477c5e2126f1e5b6366e37ae59294109233c00a1a29b7cf8258a293ad27942608c4bff481d6a169af390e12e5efcfa3298f177b9dcd6043ac32639f4506218182b404265f36807aefb26b78e86906471570c5490031989e4b208245ea8e61d47ae6ed71d741ff41a119b2fae02f633049fa14d16e1959be0ddfc159032bb7ca335c599632ec7d8a188eadc2821820cd467bed824e260a1d5d3f27819287fd349b2fa375b1e31eef4d96ee31ca8b36e6cc846b61c5c3ecba71a9fbde3289bd66558de7798daf0d919c396a9d1256ccf3e278e93fcf5ec112019d3a001ecededa3d2269850d318ff76a927f6292a81a3f95ef4e5f5a6a37b88c45b1621ce2d20fe0fe1d88e87ce28248f1a7ef5de46b7da63b1b0afe8ac45626ac9b9402b0a999a45131ed232f9834e7d40fb614e93dfa021ff06ead411a71d655512f67e58060931856e750bd4701d811bbcfdb4e9c133cf6a7f218c6cb62ce6196f69ef3ea60afb3ced3859994e380934faa22c36d142fde29c44265a71d05d5dacb8c16c045ed1fdd25d22d56b4e188dcd0ce326569149f4c9511c14ccf8cd21ecbe13cd3407dedbe90c87d1bc7e34302e7f2002848aa7db9a8a94dbf250383b947fd98dd46de554ac9154c3d17f93a0270fbe64c7609cb621be6c4546c2078b0096276a147eba96cd5944f7c3aabddcbb4b2f458b100313968cb65105831659eac459afa88a4d7d167b998ccdddf51df2b27c824c58007ac61527dca1605271ccb6d9d5c74b719953f57e11db92bd00c7e56c183660aff08bbc411324b7e0de528f5ed90295a90a9ea04eb95cbf3722d6491b14432689616c01269d51d5b04195fc21fbdb388dbeea55f5f9c473c148a99b4fd0bd63f7dd949e8bc6c228b867ac5bd4b34396c8ecbbbbb9196879c953a9020f53779fe944b317b2a4e16c4ce1d4c75b5383be03a0a3f827d1c561ea5217d20f7d9edcc77f64224465cf1d3c9f11290960245ac749e2a9a444a7ec943664bff4ed6942f5cf08d58260b4a36025c01d5369d1fb31c81c0710c157ee6497a003c063d91a0662c9cfa93760ac8c669fdae180bcf2a0282b97d30159a40cb76680ca89cdadd2b1f9b5ed4e6d18c093001415e520ea7d69dd5fb34ccbfa5213172595a11ae9c2df50910463d5c070bfa7f740311a29037c06009434685de5482773ada1824e8706e685ec6887ef32e9c1b52c72ab77d0a6212e0562b0849eb72e9929b5168403916ee4deddacb22eb1a53447db648d91705f00cb27622218351213683c4aed4ac28ab37b5d404730ff26406f446bf6612fb2c5c43249bac7f891f22abec970c72af22a7c813675a28dcf575296c9f8ce00675c2a4235b529f5917445ce1bb4140a7868d0e89ecf9d1d13a1f15ff580b06175706dc7e3116551f468fc39feca354bc4efb8a06c0a4266cd3675850e8bf00bf5f6036d888c32b682da850a139ce424e9956fc3c47fe696530153383909c348a6985105f7606a1636dcc19c0f2835d9247f167d8a0b357f631474bb1e0f7d2ca77ca572124f2e74b428d7b2a59fdb836b61e8d14dd5fac3e121b71c1cb9af42eeedf871ae348ddc80be60fcdeb9d2d2dda6cc09006764cce13b06dbca6a73389508df0567a9af840f3b48a3c18125abb890d6b0415612e1d2d1e9a6b275a54bffb243ef8dadcd39149a1b34db10ed276f820ff286f05239cb808ecd1bc20347274bcedb71e505cc23efb4bc323b7c0ce3bd5428e606d152ac7e007fd1279d8b25919e53cb93576664a93bb2f894b187ab3ed9ae0c0b95a4adfcb6d655905d0c8a344bce4ee93e69e8c4272652e4f21fa78051959cd90ded6b995d46eb19bdcf9bd3efcf285593d00cf1714ebf5866d2b1f512b7b4349d73e0a606a213b7a2947c164729c4497f6a270257620203e2d057df739738ea7d09278b647c15eb04bba56e7afcac44c70e755d9d12af98b66401679eede73a37c63a18325c7791a3b9dca824dede5cb09068fdc6c9c6cd2af8d2e7811c4f8f3180ae03dfd9d4bc50d6071728273a6888741198df9fd0c376e852090b3566aa4dc0a26c27746f7decebf2e26decadccc1bcaf1b94324299d87888e61d782621ae1e857ec8a2c7c4806c6230fe14c2776a66f832d721af0cfbe2ca46df125ec055bf66f9f5a0e9a1ad4c6c0cb5c23f815f91e348ae4a673ba53efdb33ba7fbc32cdfbfd475296935cc6f7452fe03e6319d5d22e0141b8bee73d0f3166cb2f1db9a329f281481396b6af2cb5bcc8d17b207e08750897cd2f2894803b37a72ca3581ed583fd30e811ee2b16d5384eb2307b4b01852ca1be3de5dbe6f6417224274ebcd24163bfd3e315db584dc1b9aab99ac24a364ae2f711fc645c19e4110723f31dc6adfddb2cf7c95dad0ff35dd08276d1f95ecc271b564172c6d35f0ad5c6c247343de3b59a833aa9ce1abe2b982ab6f3e00c12f198e4c58739d101eb7b65977a22076b7d0afcb565592e1f4a6c80c7e976e5305868ff997905c2a9fb824e414a58560860c48fd8f79130242f04182ee0b1e37f0e643e4a722ee394fa9deaa2afc7447652279ecab6eba78a920beb5401ca2ef826ba4a3f8ef77f23aa92afbeaed9e36eadd87c7183397126a8dcb7872e8ba9dc5c0c326e9b4f7f800b642dc84a3894ddce311bfdcc1c8cb532eeef09a6b0a99f66be6d4de7faf4026e0818afaef74bb6cd89f88adc50f28e96a90121a5f11911eae76c2f9bc8be2f97b7e967ff6447b2c844571b902cadadcf2bfc72ef958cd0d417b4aa7ec947f641d14900f2b8f579f488c10d73019a446f7b93eb3642c21788c6067cd220b76a773887318a9e1d04fc61c1e7ddccba6b2eca180f534cd249dc88e05924434ea7e33d1981b6efbe300b87e317b37351aded9c0aab4c17387bf9eeed3928d4398bcb664491058db1f35aa3212f3a6bf789f7e504d08d3ebe404aecaaaf4949781bb78e35e578685a1cc0ea4eb4d4a0e3c0e4ab39698e9712cbf9d53d3ae1541989467b52a2c02d5bb1493055840ed5f3118f43315c1a6f27506e67ce0ca716c66945cedc55a402ff1eb6d86282b1b245eda77deb6d103df05d4859037f976a9587f2120b2b8b343842b037f9515b75e0131099f735bdae7e5518aed9a3651f800a33b9170383257b140db189ab2cca9a90aea9a1858127d5692b5ec73d2f7b243e49d49e0208c5bbe5d48d260134c3ef89b762e13d1240cf4dae1df66b08390f3e309ae93f4127a82da5d456128beb34abe1e7c19a94016c90c211cede0ee645522c6fe827a484d751d5b15f499a9d8df8f5f15e62f5c65cbd2ae5501e9918bd6a0c4bba7add791aa11a215922d8494cffd6f49634fb4b449f54c972f450f88cf1d67056a839b0816e4d419dfc9eb83774551e0842ee6484be3919a416c710ba1ebf90f4bb52991a6db7fb0c268a0587dba9df8eb338201dfd1b68d967ce485bfe17e9aacc7bc6e72bfebd5007e795f612dc9f5f650d537898db74ed85b0304d39e0b8cfa79e3a99249b3217986883b1cd0a399ed01df2c4cf35cfc991ad8ce2191249e3c4e01dd441a0600aa10fb3eb3ec1721cfc74bef9d02aae268e77e3fe502573b8412f28873571d6a08dc62e0ec28b2863952fb037fe5b6eb459a539b548cde7058a37b1e52a5b0ba620e489202f1648b7bf90552e06db298300e0a09c6f1b7056879463739a52fc82af1b10d2b286ea0705d213b1aa0de205a5d7df37c72ae657599c5137e785a76fea86f0d2c6924cb0e22dec4ebe4d09a7c3ca0d82f1b1d01982d3f19003fd8bcf28b7e2e82c9965460c294dbb0b0a8ad874b12c686aa6323be816ecc1dc8b88498ee9a08f4dd507cd2c9f08cf8ef7682bf6b47756af892fb4f282c54825fadbfe4cc7a4658d980ffbe89e9806043076391808cca6f31ac70b476d4c5d7cfcfbab3af1b33fa383797173b2c2a03ff5b72b4217228986613a6e189e68d8672db20b8dc7467d21c1af66d2bdf7b8d7f12c725332acd0045e79d4e7a9767571e82965435836b01d584c49666c1942f7d53a033b5ff4bf9600ede3279d4e87511d0a67352ff625383e1e41776c045e0d2ec9c0c6c8be72bcefa8593b6a9c7d405ffe5cf65a7af40a6898cc6ccf77da28caac5852db0a106b162048c417754b2abe95eed67667703140815459aaebbc6e7ac3aa8c9d926ec14d7cd7816a4ad4b80d6ba9cfe1035c79dbb7255cecca73def829a19760671ec046de49a4f3c255ab89f682389dc4dd9abe7ea0b92f710ae1b49d0d70f1e7411e32d3975c904ddc1bc780a70845a12c7cfc33fc547916afe96f79b81b2f022edf51da416501646b6bc6b5896762e2f9bf493bddd609bcd1a8e5fd464a1532aacca13de2d3062916edb2e94e0e7826334ed229b451ef05f36cf322d29bcac32522edb0dca64ee49df0e6b6a754890734f18f457a474a83858a9530981fb02916aa12b9db11ebe6f27b9904e74ce62f1364e4bac38f686493fe83357c9ea8696fe288b86dcebd556b785ae5a7d03afba58dd3acc1b70449d7393c781125475591373a9fab1c153a42d6df55683c6fc21ada2aea8d3967257a7b7c5c16ed7ee896c3cf1f460ffab1cf4de938f4f6278095497bcb6acecb138717cbc460f1ec9a7548436989f73ab18feca7a98e2a8cc1c15e3964688265ae1df0fb9ce897f323d2397b8d4a314cd82bb23c5935d154f964b6e459d5efb287cb151c14400f77022ffeec67b8a2d202e0a6e41d3a60fd679fbc5feb085c5a70d0b558dfd1a10cb1462ee9f052d1516d7ffc16a1aa7fa0aeed6d3391c52a36ef0b60445002198f4ee5a0d53876004a4b3bf85e008b471626090a4bd637b6229cd88295da5368c73279ebfac0849ad4c5baff48db17d5edf3a7a401327200a76d1e67efe93c48d292a1b3d44831e0e7433a7f466708816fc9de78eeb751951136fabd272d6cd20cb7fa7b4171da6a779939afb4e8fcadd51a4177d5f3656454314df0aa582dfccd9abdde8a3f25525c47b2238aad7f2553b5a9f6d1e9ce2e2ea5a5602ddeec9688f9dcc65ac809eca63c8d3f99930f8eb105003a8af3208e3ef7031c67c6464e4e89165b7950d583e6a73c043eb972963259a5142737cb5c7b219ef1da1e757b6fbd84a06ad1f7d1e143da61e1f53dc12b77d396dd0f33ecedc9fd9512e1e197552694a2b419f2a3e7c60dc7bdbef0d5ab5deddba8197ba64899a348e38e02a9e997684a9cbf3812f0e0313f85b06e167187ea76e9f1b73227e120244b6d9e2f99952aeb675c177c9fa0b6b993dedb5201e5ef0f3a333c2a13925e47bf4ca32cd7a094161fb89fc8f5e95c12480daa41455cb76bf605d7e6a13d247eb642bd5a5a015b3bf174b495f9df7c13f4a8684c60530375e4a1649db3f72d7be32bdd9e82c2304f1efcbed722460519e453d71c3f07ef3d9cd6481a50d0064194a183a8fb4e341f7ce6c25404f8cf950ab487d5f4cac083eb6b700aa7b99ad5ada0eadcd88ae320eea62d58b44ea1e9b6e3ba6527c76db449f04870c49499a41d1c841c940d81dea2da51492d5108de457941f47baeda8a906a6d0c15ffe8e092223a84ffa4f11f3d36845ea31bd5a5adae92ac0ea8bfd6957556192a4af5d5344e09a6718cacaab04a2a91eb2fe5355b404744430454e23a277cd4e7daed1c8f45f6f3750a5d379f59e0157731b1c49df9bab903fd1437afce1db17f905c144f6b78a9ca73f28d3a4d861d79a23fe4ae8b04320a412355e629113de7c0256ff2b59b5b4b02554e689412d093ca79eadfbf65ee633862097b814650a6467d4880c5cdd09dbda6dd86866ae837ccb3c5f9cadb4a38f69d62eed5227d2ae09b7b9263e4960dd464ea4920426184fd50352230a4bc8e0be3fed0b658f3564e735202f8a2a1388962f2c46bce1f671f80f96e222e9e442e8295872f32af3ef27530f8b175e2b72cef33f8130804c8b0c0f2a2534a35b754a14f9f26a500239fc043da4c9a74465575c06b7b1e617d8ab29ad7bc7a3478d9fc0611046c88ccd0aeacbefa36e0fe1e587f98fd0efeb9f73b183e6eeeb717a4282734c97d47d9aa8ef93711214487cd1512492e13aad17dfbd8a40598021704b7992613207252896959e39a851cefba861e209b38f374e0d6f7d73d88d28cefafa92569c416195b4ec90633bfdd596076277e281e0db25135f5dc0d6ca1fe1ab0760ad2e1f35f85400fc461bd48eb454469272790698ea2e7f512cdb7c41d54297c9de465a1d9eabb46313c4ff19fd7e627fd736488e0880e1b2775466e3e2df5a89edb8dc2591e2a44d4ecfa434ea0f8d480319d0e112b7f6e4b6d759ec7320ec09a8bff4d58a66a25601b1b88891798364144a695ea1eafe0df111b3415a81b740510c959a51b014a5b0aa5d9893f9fe24523758801aaa45fab7c89bfdd49c6ba78a19561e0bf28b7556594b3d7f520bdadf80652f7347b110323e94cf65f65b3f5bd656837ca39ba451af70d301d7d8e260d268b9e33d115d82be58e76ade3581134f182d1b65db437bf9620b152d57be7d72ae28710da30751842b349b10cd3c7aa704ecc2e6dfbce63ce899793f8bf580f73b07fae00905300026199da05bc30616864735e4a6ea39b55c7aa59d3602983115678df16473a0a8cdd64412f119c316b0bc417e7ec22f05dd444bada7d433a5ce184a8b429aa79d5995e7462d11a633ab9552743d0e6aec4bbca00f810ce262505cd7f2dbe70bf84c7cfba7ef72cc56751921e7ecebbe923d9951ccbc22c88cbe1d8c033864495d87ced42cadbf312a3e1eed0150221a701de0a1ff22d6871fd36408bc24a99682acbb5038afa937512eebc282ceda258f85a6d94162cdffeb9f0db42e9c77e4068597fd3be9ea7d7497f327da50e414717b150fdf4d5df25b8c92a607377777210582e5a021d6d41cf10b0e0b948c8ee880d0f753de113ceb76f88c23c7229dc5ce93e41fb63dc24f3293ab9f9403dd4550d5b2da3a00f8feface68d14770d3d2f2826e99055f0a10de6dcd39d7c432786451463a88cc8d6808678e8783ef8351d8496e7ae07caa59a17fbc558c65f6c70143db8b92cf985ea45b2d4e6549c18583403916ed63cc913e9f082057c3ad24c477d3ca66a363658e3520ea97afe1c8b9fd2cb5baa68d43790b3210313763c8600d475d4d00ba44d07e0469496f5ed5b334ba4ab23bb39b4c86e654f74100dada0bb56d0776d26e772c3501b7dcabafa5ccece19c5ea955b34e4908bb5274cf0d08fc03105669d2e9e62afa1d23e04287bb5cc4ad963b7d196b32d958e54ce677d8a8b4bb81a960a7843484425f06f8db47b695a850ed759f0205754575c6856ddba55567327908b46cd5a5caf99e083f4e761a2fe6f439e1c1ccbe0bf21dee4a1404f1a54c43837eeb64a1890f30ec39cf14e9ed1f137ae34aa0de55cf72b46276bb55e0964959de496562de3247027d1a5e4225a72a8a79cfead783a08e54f138c305acd06c70557b9af1025237b6b17a17266e566ce4f5e188e0013f0021df95c356c9eb3be20a2f82fa7062da082e36e0eae62b8e2f263613413dbab22740a6f845bc8346f13e2bbd3ae100327930ca64060e2880c9cf3043b106ae30c70cabbcce6cb44035f1a45e08f6c13a8670d69b11b6dc57b317cd2bba27aa6e999f4145fb12728937992a92195d340323a287907f104a08f84017c1f92318896166aa6f2651c589f537fac3ceaf731c4b05fe333759fc22a0f2f9837cca1ff879d030aa334f6b83bcfa1f685bde04398b5a90033f0c694319e76f32a87e01656f4fe297dc27c03fd8259018503e9b3006030df791271226dbb5972d6fd901e57279899832b7b589cba895567b36c17d77b1d474667cc8375d661ff4f5eb67dea4aae3fd43baf0a805221f9567fd62a3de9ea5ba2b065c0b34174ff500fb2b272a826c89b0089adcc96fd287d69f36cc12eb2cc10a99961ef87deede8f85b4f899ea60ee1c418ae69cd75c74d8d653377a93e79dfc319938c465ece6efc402b91ac2ed2821334c7ca74483e2b32398246446aa4eaa81226f7bc2a69d7524d7e09c2db14e6419546faa069ae4c3d4de39c2229e792723cf5d0a78bb88ce3c502aff3a46890356e5b8b994ae3ed21a9e21cd5150b1dd4ffba422c1e01ca29d60c56d5b600e776c53a2eef229d5322c8dcb195e7865a1602c3870bdbcfaf53872e3ec8ce0851300ca6cd3d532758101c8d1e5c085c2df9547a65638e1418e7690c73c35e603a87a047028934f0b2aa93f656cee5466a7f968ff6649ea2e1db7f481e94d5adf1f4e8fb60ecdcf7d4f0489dd7f98d7d8d27da8ab4b5ba922bb3cb6ff56f5755ff406000864260c053deb5fc07479deb22e0e9f1245ca687c7211058bfedac5131bec70f239d1d3ae5f25f16a7d5c85c41abca77fb35ca6f76c954ac30da4c895c71ddd7c81238e08518e1c0d8007826d93003933c9e7b3aea8e8203b84efa4e1c88ca203d578b7b552f4c5038bc448f37273f71f27f5715ad948a590770eee04dd3e35af604515ea40ab36e6fc22f04e826faf6b413c3734ca87749c2c56427ee3c44a58f5c4b0130868e533f3d5f125d7bd9e1a10d3aa5b721131abee0fed4adb66d5333a5e6300a912e7ade72e5c2c7cc389b83a30d625f623ffd8fe582a46be9ad56f23adf55f5859d4449db98f7099c7766f6f6fd06f29da5792e911d460b4911d9de1873a489829d5ec266133be24051f9cdb81305ea4a6149f1c4ccd8aa55131f80377993fca856baa6bae0c8c149419f281ba77311e26b4c0117cbb082c9f7d882774b57dbfb3e85e09d9ebf36f4227c434a784a3d8c0133524dc45015ae04efbd08a6d13ef0e325a16a059409a9873885932f4b51e5b11628efff5314d03274fc19b64a28f8d18611332e111b4307467d9e72ba938bb2642c729cf3ae94e55a683993aae65d92fd03f6311552905b9e0fba76f78e5e212ec169c829f8625eff9f769fc33fb905a6c14a35ad21a0654c60d0c1f4d54ec27ef0c602a0bf01ceb0e0279822c1b20213fb78b2a63075e6baea3626ca038f296494bb26de9499a3426f137b0c76b3d7d3da602fbc10b017e10ac108a57a3e21bdcacb4e739c838b969f5efee7a44aed3aa3f19469739cbf4353be761bdb5883fd6883c5df6dc16a3bd31d1f91f46e8261e20adbd482f2dbbea2ce1dbd5172051304bbebdf8161a67768c053d3e08ccbe740e8772f7ca4aa4cd9abe3befc9d414f47c8e21d81586854d4a2c32df00149cb33d4f18efde4e0862e5739c9ba1dcdc1e29958eec1fe6549c5432a560364375a52f86a7f7285219c9c1d6c34907a062746c4b728c236d05a2f83b463d892105dacc1ef80499332893fc4ce4431f6e101d6f86476a7f1db2c086461b78e9c614ba8f447542ecabd64c9532308023208a93081094d40c8e35202a5ddef9039ef57686360dc6ba61d347fbb2d70b6b827dd1ade36f1bd968b0621c772bf7c0acf4a1b3a30ebeccce1898611b707bb3007d1312bf169417a5e95789f50391d0e76f36f5cd14b7a6648609249787890d8156c5af150a2aff0ae2c07b9247655b44449128a26616c9794548d989501e702cf34cd08b281fdebbc73d2a8a874e5a500dde9869d7ab02e57e311fea9c245c4a8a788295311744394113d26b3f5cd4081f74e0c1aa8830bad2dcfc7ebdbce03dc8f6d925e6a702af4e9528bcd9d4a2251b74850fe1cb1370d2dadc6821ebd6864af52d917f853d2162d5d36d8f4a8ec7830cf25dc413f8ed92c958b14347062c8acc17f5f386ae5727f387bcbbd4c3b2332de14a48a6f8e2376312c308471c062e50589dfffaddbca2300a712456370cb60f852ba77625f73d8c702750b841e5fb12607e35c91ef940991a49840ebbfebc86aca5829ec05baa10f5678dd92a4ca4028ef6740001ffa1c46365a88ce585681e5558112cc4827e2d957163d6c6611c1d55cf981384ee767d63576536ff0f929bc69f544bf4a3b6ecc7cb900b16ae29413b97eb2c966feec315260c43526a61027a0eb0cedd8ec127c529db20e9cff3601824463eef18f87295bbf39b4717dfabfdbdc939b6f82d6365ea9847f48460dd36d0871bcc658612c98a40356d4307944698cc6b6ffd2bf90339941c6b12ab15926448bff0e5a224b16cb565f7c3481367e1a76f772ec2923adb511ba030d34ffcc2e76d6579f6c2d2ff91329a1796b312d6f4b9075f829d7cf8420f0fcb8ea287e5041b4a7ee13a13f1d560da77e70c072b5412147d1c2071fbf1ce2c57ebb5108321f55aa85c2750767de07ad7bab2df53b0bfb8cca6f4a8f3a26a61091245435b3a06a978264b775175bba16286c41814c8231c138c50f16fa79600bf3ce4cad83f34ed8dbdc400650f198cc284d27a1d4b8f41d48bd66aeabeeed43cc68a74727f126bab5f305bc6a9ab134b84f92479770167024e82780de30d4eaa05ce41fddbee356cee9337cf1b301b3870e958f0a9b5861d993573ba4469c4b76e20ea9d73a6e38de308eeb6290b6b32c5f20c1992662687b7b462c24b69e7bfcc107fd1ebdf0f9a76ec1f7261749a3a82b814fd28586927586e597a9a61f9b516d922bf5504bd36966ac5b187a9df0518895f472c7c49f42267ba174f65e4dce6f0c949d69be2188dc5a177754ae4b2643708cb0d64b0a28a98d8e8a27ece23528d705998ff325ca0f49c0062440e1fc525a9c3ee9852f3a4ffd45d45a1e892b12d5b3008f7110cda7baba57e2477eef1ece449cdf61a7ce56851771e2b9ece5f79a59613726938b8987cf765d77a389aec2b23b50890151f8779609443116d28ef453985bcfae485cf68cfc3b3435ab72261d5d068f20c2ffaab4b0d9e0c3bfb3b29ccc41dfafda28b7c9d141d31cd648e1a031188d6083f9c9e20298c1bfa8d76c7385ec035df89d364f6d927cd9c70b14eb10e96cd01452e06ddfaaa129e470014035ef9d4a2f3120c822c1b26a8c4be9d41665c4152fcbef2a123651d3f092948c9d01ce44661192009845f68d660e078c648d9bac538eab1db142b4b2c571e0b5061765e3ba2a9c34d3fb4e5e0d9163d34aaf689b9d081aab4f6611c9db284907e9b185ee2da86c992418bac85520616974caa65ca2ebc22b9549fe2a78f8b6a82e55d6228bfe9700c6f0a68447b3b59fa367458aa3de1201fc49b8fdd3eb99ff91e26cbdf13ccfbfca273f4828660de8e07c73629e87fdfc259306c34181f3d6a8eaa7f91c487e9684e61bdb67f66913cbe785881057805222df5d861213009a5990b0954a57cf456fee1f5032e72ce4c38e250a9bf5ca7939ecb70c99e6b3133845828895b29b9b910915d1294c8404346ed6689651686e7b2078e2879d125a2e467db8a1ca12c48ede353c38840d5119c475f94469cc9f3fe95d50ab1ae008df87343e72171692aafd8e6c3b469843b61556e383ad5ed8a872f8ef51ac90f153500651fcaf2e3036edbe911c5801812358ad76eb9b5e51d8d3241d48b034c116f6b5ce79b5ac8f4073d6356c2c531584d5c60532c4f12c10b14988fb92a82500939d5183fb7ac02f7350a76f5c57a174591d7e072a15dc2043e11ef821cb931becd0da1ef16e69932b35f8f95da1327365bbaa00dc7e9b428e2cecdd9e3ee0c7bedf28a76bbdd92194e0bf10ef6179f9e4fa21e36e978426c4b1c064eb10edc0b91cb1482c884922038234bccfa0be45add34ecc34850bbbef99f599ed76aff8108111f1702878bacc2d994571a59c8fa6cd0a3ec742f431fc2453eb6fada41120d3e4073fc1f3f5878dc710dd4b7e645c24cf97ac248b159ecb48a88a21efff2d351e4614a45b3e2c74ab2ff9a3debac6932efc906fdd98560ef2bdb18fc883b253b54baa9ad8379c2053041b8f73716978fcccfaf78c3f200eabeed0b2501fdd3eef4ea0e4933c5e1bb1442eafe7767e13a6a2fa2496e95573e569468c02f55a3c1c314c18f66d35b9532605302856ca80f46b60a1e762772baed0b9f16881f58cd3f68483049fe1f8a5a3b92ffe0dd0db02bba2302661b55570e896848d6782eec4c2f5ab6cfc5865ced3bd627fae9150b95ebed9a3a05deaffd5dee5688cefd851df4247b212659345a739f0c83b9b7386abcfd9e4f4fd1001e6e2e9454c4e6e7140f52e0070a598472aae86b483228b9b921d75a675a74866ecaf168a1d3898b44910495888f7a998f4d7e5be537e815b33962c8ba2fdf80d06257f3627c5a9369fd5560baabce7f7c9f5152751b303508d88ef12ebd68c0703837821df77e9138130c69e8a5d78d4c231e03f5e0987c44b9f6fa00b489699a682e6fa46f4456f652311d85065762027ebc9bff73fb43840c81e1686ade1921c966f4e002d74cab69ad4940ac2254dc725bc641277e48348d3f5c41f6fec033c70c5f00c047b690996d3a6262bfc4efcf4e909bf2709620aade8b851d2c1b56ec598c58d9f8ddde01e0288a6f50b70e1bd190131e990f6cbe95f0ab6cd8053fc31d3017c65b52ca730ffd100aa8540eac0a89758d75c7bdf84e9451835bb564ef07b1ecb55437e802a4e9f6acc8d2fcb60f34b43b71ebb2fc5704397d1c85cc50851e2b1acdc756045cadb4992934f012d59899ccfcbaffef1044c7bf4d75fc8ef455534b04c6a2d55b1ca484bf78014618841202b970beb52da69b9e84afccefaa5ceac85176d1c2efb18ffe0ca7b8326f23370586c61676506a68f50999869cdb25cb3c4ee01075ab60ba9966b80f6e89c91ebfeeb5416d1f5e2cde7311abcca7ccc02cdf34c496032d226ee3604e850805232316e884582f6f2bb160af6ad3f3c11977ed598521211faf03d1273d66be403003bd873bd0f4b127a73caa12d69a6ee6d92db39ea392cb184a054d820f5698db40d20a7c6e909e89e9fab719a19d922cc508338ef57793a42dd490459db698a771a28bd676f31377835276f0c0da6b3b4806199cd828b5ba92f98c698482de4acbedd34af03b4001ef5f2d60ff145fa537ea53d7ffe2ab3b0606c148d466bdc83f1e9b2759708be2a261988151ae006215c5655d98f18e9d9c852bf7d1b0e99d49ed44d1048a1fbe2386909d1e78fef87d7c347a34947ff710d2b571f7b034c1e0866c84e6fc5ad1efb5eefe28ab558cf7a2791fbd091e355b10af855296f0915897e7804a02f766fa53fbc963fa608fd93fd05fd552463d24f8d1f7ec4751a8c03a67198807439e996a7f45524314c9fbfedfde92b2d8621e9b47a9b0f75282133cc094a59037dfaf9a10c7849ecb90277c0935b115c105dddb7fbe9d7b55eccfdae1ec96dd24e720fda2663f616dade091f73d5d477101bcd5776b97cb29ace1a85902a24ba1c5c5586d57e040ca00d21285b98ba711c934f201a56f3a49d8927d8f0cba54c0b192529f32d6b9321726ff1b6df94a66400152f404f97038ee6952a78a911eac4e40acfe5a7b97a8ffb69e949c3512a49580c1408ac8a8df29498d40e7dacd9f3024c0dac1196b21cc778d18e2a05fd9fccbd815d6eb1b6b2ed91ef5dfd2140e0f4607e64c08b13b272b320a825e0581d5995a51cd3314e99375b9f206bf5de9d36bfb80c9044953b89ac77547ee6db40884846a704d189b6d68e503f580e8b5cfdf66934219cb8c887c56a2816bd8f62ded9df228ffefb3fc37e8ad7c339bd7409a2edef5413e6ff2fb1093c5a9e267d2ebbec80c4abd4cc506ed35657fea42226681766408ceba487cb11f9c792238979200cc1d86447851227ca8cb9954bce9a9bede16757608feb8d3242ebbdb2e979557729379018ce2e3f52e5a8578f7378101563343ad9cbbf543f488495f0d1e5a01b890d2148856c5a287db5973de76112ac5b78cd11b8bd3f9be374ac357b372713406c8460cc8821bacb619bc34d63c2dfafc5ca954122ce8f7aac3af39aab62e41f375069990650108d557c7530c5676c8b622257673d919c598ab770c2cb76ce01e44adcbf6d183bb6f6fa431ad1d8ecf12c3dd6b713cbfb4938a1a95394091a208ea63be8ce5588be9a269e677ccda04a999e6c3bcd3ae0075a4a22e86d66ee1db3b470454568a4b4cc7748c1d75192d3b98b704bab6a12f83f1af993fa6286c3a64beba1b605db32f67035fae2ae4a65d9d088c7bc191d487cd230f3d2f97fdf4a4e8a90ee2c09ca9b592dcb2594b9d68dc2bf98ebeb15eca676e03838a5e8d649923870204bd193ffd554d7efeb094ce7b723f22d86771fb9a2b985dc8f5784cc080374d3e6fe732265dae550bb9e3f1259058aa5e9dd879b77774232c531b70a3b6cfdcf08c8a27b0cb1239423c447f32657ab0f3e3b73d49ae22c453a758591982d964e3e717060d6efe92de24f69d7a08c1f9f34059c4c9038f3551df61a7df96566166e342ec9b47468c2b22ec3af3fa2836ffeb5f0ad85f2babd4ddd921792d774bbddbcf1986f10f071ab517d66f849a6f237cbdf1237ed92fc821b7b45fe465d7249be5247dc4cfd101888da429a288b1f102f96cb4db74fe304ba736d82e5eef9bdb4866a842bd7748a9cbc44bf2e9aef5e22fee119d350272262ddce1fa546632c92863946806471c29d48e2a35e342dc90af32696407711dfea3ce738ceaf5fc47638d50e60ef1f4e29a327223f1bfcb4caaf82d3024d39227d07d005fbc71453d86f4f76fcf3411594fc7c037e1522a968ad6408f794b96fec5831989f15caddcf340aef956abde61cd931e14de0b0eb58717be777643caca789b00f1a18796938c710c220b2ad0fc83e23d54066a66ae9b90a29f30e09441c57be8e3ba5603c04d183f148ba46433ec471d0161ce51a2e3bccfdf86ca3c5653ec8b324d336a4f3465e72e1ddcd61d35c1a1af51db4bc389c0c82b9bc25909098d612e890ca403fd477b6bd6a98d4a259f58c1c5c0fbb5382e607a926811daf317aff7adffdc7b1084ac369d1ca2fdab64dbc7d4df3e3365c8b779280eb4c212f87a55670c1a0ca2031b9d7ff6eb4f2de0426b624f7bfaac72edf6302820012e94bab43da2e7efe5e25f3749400e9c61ba33f1359454fdf3d1f20fad248b28e8df7311edf44e405d01ac37933b77d745086880b5a3d7e743f03bcd66ca33b06906f79325ca96db265a04ac51973e7aaef777140d360fbfe729b10469fca497aea93ae47460574c06b22425836e42eb2b872385c6c89b0dcc44183caa2375d1cfed06e1eabdb7e0994c8894f252b9aaf4cb7e99d6d4a58f4a24443cbe5650bde8e445e0ba7791a5aa0c5710551ce712dbddea7b040693c65d0bca52dd399c08122f4b69eb30bf324b8ffbc805b1c1d3d1c809c985baded5b6e1c47c6793986aa77ba85a8c5dfdea59f34b58832ca0498fdae0b61018a442e7074938d73863a08ec046e8715e4d5cada228ae1936761d9986047d3634fc9a38da6d541b56aae345ce90edd817f7b7a327378de529b0d2b7396923db4ed3f8d0ad26aee3ebe44ee6a749ae973a192c071e59561c6960b74b9e9d06e012dcfe48f1d0569f80b40aeb1be83fc3aa71b239308920fe2b7bf663678f7f8c88e1fc5b466c319ead63db13791ed88159ade55f67411be696cfca10ab138beb1c97ac7571f773815eb36b52dbd3bd7d00b0bc7f6cd73a8162a0fc9d05d7122d995bd3802479fbcebfec44d375622abfe2779cb375b10fba18c49f4c4a704a964439c514ea454856dfa34d0ea4575449471b886496e303578f08973b9878868e33fd69bca4ccbe6624236b4bc8e75293eeb0094ce75f03066cea58b0a32f6f9039bc5f44f79532febdc117e98132ea927a1b8f944b5dbc8e0d3a1656b070d32709039cd76dc8cff5a3dbf6b6d390c7f813cd0d51513be50f1ad8f7c0ded2cee20d2d20f387d206b7ed04b153787147dd7d9631b65a30fd1ff4edf246b8843c6212b5f4504a4e2b88eeb853903',
        salt = '993509a8a762d70baebbf04b5ba90c34',
        labelError = 'Bad password!',
        isRememberEnabled = false,
        rememberDurationInDays = 0; // 0 means forever

    // constants
    const rememberPassphraseKey = 'staticrypt_passphrase',
        rememberExpirationKey = 'staticrypt_expiration';

    /**
     * Decrypt our encrypted page, replace the whole HTML.
     *
     * @param  hashedPassphrase
     * @returns {Promise<boolean>}
     */
    async function decryptAndReplaceHtml(hashedPassphrase) {
        const result = await decode(encryptedMsg, hashedPassphrase, salt);
        if (!result.success) {
            return false;
        }
        const plainHTML = result.decoded;

        document.write(plainHTML);
        document.close();
        return true;
    }

    /**
     * Clear localstorage from staticrypt related values
     */
    function clearLocalStorage() {
        localStorage.removeItem(rememberPassphraseKey);
        localStorage.removeItem(rememberExpirationKey);
    }

    /**
     * Clear storage if we are logging out
     *
     * @returns  - whether we logged out
     */
    function logoutIfNeeded() {
        const logoutKey = "staticrypt_logout";

        // handle logout through query param
        const queryParams = new URLSearchParams(window.location.search);
        if (queryParams.has(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        // handle logout through URL fragment
        const hash = window.location.hash.substring(1);
        if (hash.includes(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        return false;
    }

    /**
     * To be called on load: check if we want to try to decrypt and replace the HTML with the decrypted content, and
     * try to do it if needed.
     *
     * @returns {Promise<boolean>} true if we derypted and replaced the whole page, false otherwise
     */
    async function decryptOnLoadFromRememberMe() {
        if (!isRememberEnabled) {
            return false;
        }

        // show the remember me checkbox
        document.getElementById('staticrypt-remember-label').classList.remove('hidden');

        // if we are login out, terminate
        if (logoutIfNeeded()) {
            return false;
        }

        // if there is expiration configured, check if we're not beyond the expiration
        if (rememberDurationInDays && rememberDurationInDays > 0) {
            const expiration = localStorage.getItem(rememberExpirationKey),
                isExpired = expiration && new Date().getTime() > parseInt(expiration);

            if (isExpired) {
                clearLocalStorage();
                return false;
            }
        }

        const hashedPassphrase = localStorage.getItem(rememberPassphraseKey);

        if (hashedPassphrase) {
            // try to decrypt
            const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassphrase);

            // if the decryption is unsuccessful the password might be wrong - silently clear the saved data and let
            // the user fill the password form again
            if (!isDecryptionSuccessful) {
                clearLocalStorage();
                return false;
            }

            return true;
        }

        return false;
    }

    function decryptOnLoadFromUrl() {
        const passwordKey = "staticrypt_pwd";

        // get the password from the query param
        const queryParams = new URLSearchParams(window.location.search);
        const hashedPassphraseQuery = queryParams.get(passwordKey);

        // get the password from the url fragment
        const hashRegexMatch = window.location.hash.substring(1).match(new RegExp(passwordKey + "=(.*)"));
        const hashedPassphraseFragment = hashRegexMatch ? hashRegexMatch[1] : null;

        const hashedPassphrase = hashedPassphraseFragment || hashedPassphraseQuery;

        if (hashedPassphrase) {
            return decryptAndReplaceHtml(hashedPassphrase);
        }

        return false;
    }

    // try to automatically decrypt on load if there is a saved password
    window.onload = async function () {
        let hasDecrypted = await decryptOnLoadFromUrl();

        if (!hasDecrypted) {
            hasDecrypted = await decryptOnLoadFromRememberMe();
        }

        // if we didn't decrypt anything, show the password prompt. Otherwise the content has already been replaced, no
        // need to do anything
        if (!hasDecrypted) {
            document.getElementById("staticrypt_loading").classList.add("hidden");
            document.getElementById("staticrypt_content").classList.remove("hidden");
            document.getElementById("staticrypt-password").focus();
        }
    }

    // handle password form submission
    document.getElementById('staticrypt-form').addEventListener('submit', async function (e) {
        e.preventDefault();

        const passphrase = document.getElementById('staticrypt-password').value,
            shouldRememberPassphrase = document.getElementById('staticrypt-remember').checked;

        // decrypt and replace the whole page
        const hashedPassphrase = await cryptoEngine.hashPassphrase(passphrase, salt);
        const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassphrase);

        if (isDecryptionSuccessful) {
            // remember the hashedPassphrase and set its expiration if necessary
            if (isRememberEnabled && shouldRememberPassphrase) {
                window.localStorage.setItem(rememberPassphraseKey, hashedPassphrase);

                // set the expiration if the duration isn't 0 (meaning no expiration)
                if (rememberDurationInDays > 0) {
                    window.localStorage.setItem(
                        rememberExpirationKey,
                        (new Date().getTime() + rememberDurationInDays * 24 * 60 * 60 * 1000).toString()
                    );
                }
            }
        } else {
            alert(labelError);
        }
    });
</script>
</body>
</html>
