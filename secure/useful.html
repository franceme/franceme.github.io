<!doctype html>
<html class="staticrypt-html">
<head>
    <meta charset="utf-8">
    <title>Protected Page</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- do not cache this page -->
    <meta http-equiv="cache-control" content="max-age=0"/>
    <meta http-equiv="cache-control" content="no-cache"/>
    <meta http-equiv="expires" content="0"/>
    <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT"/>
    <meta http-equiv="pragma" content="no-cache"/>

    <style>
        .staticrypt-hr {
            margin-top: 20px;
            margin-bottom: 20px;
            border: 0;
            border-top: 1px solid #eee;
        }

        .staticrypt-page {
            width: 360px;
            padding: 8% 0 0;
            margin: auto;
            box-sizing: border-box;
        }

        .staticrypt-form {
            position: relative;
            z-index: 1;
            background: #FFFFFF;
            max-width: 360px;
            margin: 0 auto 100px;
            padding: 45px;
            text-align: center;
            box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.2), 0 5px 5px 0 rgba(0, 0, 0, 0.24);
        }

        .staticrypt-form input[type="password"] {
            outline: 0;
            background: #f2f2f2;
            width: 100%;
            border: 0;
            margin: 0 0 15px;
            padding: 15px;
            box-sizing: border-box;
            font-size: 14px;
        }

        .staticrypt-form .staticrypt-decrypt-button {
            text-transform: uppercase;
            outline: 0;
            background: #4CAF50;
            width: 100%;
            border: 0;
            padding: 15px;
            color: #FFFFFF;
            font-size: 14px;
            cursor: pointer;
        }

        .staticrypt-form .staticrypt-decrypt-button:hover, .staticrypt-form .staticrypt-decrypt-button:active, .staticrypt-form .staticrypt-decrypt-button:focus {
            background: #43A047;
        }

        .staticrypt-html {
            height: 100%;
        }

        .staticrypt-body {
            height: 100%;
            margin: 0;
        }

        .staticrypt-content {
            height: 100%;
            margin-bottom: 1em;
            background: #76b852; /* fallback for old browsers */
            background: -webkit-linear-gradient(right, #76b852, #8DC26F);
            background: -moz-linear-gradient(right, #76b852, #8DC26F);
            background: -o-linear-gradient(right, #76b852, #8DC26F);
            background: linear-gradient(to left, #76b852, #8DC26F);
            font-family: "Arial", sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        .staticrypt-instructions {
            margin-top: -1em;
            margin-bottom: 1em;
        }

        .staticrypt-title {
            font-size: 1.5em;
        }

        label.staticrypt-remember {
            display: flex;
            align-items: center;
            margin-bottom: 1em;
        }

        .staticrypt-remember input[type=checkbox] {
            transform: scale(1.5);
            margin-right: 1em;
        }

        .hidden {
            display: none !important;
        }

        .staticrypt-spinner-container {
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .staticrypt-spinner {
            display: inline-block;
            width: 2rem;
            height: 2rem;
            vertical-align: text-bottom;
            border: 0.25em solid gray;
            border-right-color: transparent;
            border-radius: 50%;
            -webkit-animation: spinner-border .75s linear infinite;
            animation: spinner-border .75s linear infinite;
            animation-duration: 0.75s;
            animation-timing-function: linear;
            animation-delay: 0s;
            animation-iteration-count: infinite;
            animation-direction: normal;
            animation-fill-mode: none;
            animation-play-state: running;
            animation-name: spinner-border;
        }

        @keyframes spinner-border {
            100% {
                transform: rotate(360deg);
            }
        }
    </style>
</head>

<body class="staticrypt-body">

<div id="staticrypt_loading" class="staticrypt-spinner-container">
    <div class="staticrypt-spinner"></div>
</div>

<div id="staticrypt_content" class="staticrypt-content hidden">
    <div class="staticrypt-page">
        <div class="staticrypt-form">
            <div class="staticrypt-instructions">
                <p class="staticrypt-title">Protected Page</p>
                <p></p>
            </div>

            <hr class="staticrypt-hr">

            <form id="staticrypt-form" action="#" method="post">
                <input id="staticrypt-password"
                       type="password"
                       name="password"
                       placeholder="Password"
                       autofocus/>

                <label id="staticrypt-remember-label" class="staticrypt-remember hidden">
                    <input id="staticrypt-remember"
                           type="checkbox"
                           name="remember"/>
                    Remember me
                </label>

                <input type="submit" class="staticrypt-decrypt-button" value="DECRYPT"/>
            </form>
        </div>

    </div>
</div>




<script>
    // do not remove this comment, it is used to detect the version of the script
    // STATICRYPT_VERSION: async

    const cryptoEngine = ((function(){
  const exports = {};
  const { subtle } = crypto;

const IV_BITS = 16 * 8;
const HEX_BITS = 4;
const ENCRYPTION_ALGO = "AES-CBC";

/**
 * Translates between utf8 encoded hexadecimal strings
 * and Uint8Array bytes.
 *
 * Mirrors the API of CryptoJS.enc.Hex
 */
const HexEncoder = {
    /**
     * hex string -> bytes
     * @param {string} hexString
     * @returns {Uint8Array}
     */
    parse: function (hexString) {
        if (hexString.length % 2 !== 0) throw "Invalid hexString";
        const arrayBuffer = new Uint8Array(hexString.length / 2);

        for (let i = 0; i < hexString.length; i += 2) {
            const byteValue = parseInt(hexString.substring(i, i + 2), 16);
            if (isNaN(byteValue)) {
                throw "Invalid hexString";
            }
            arrayBuffer[i / 2] = byteValue;
        }
        return arrayBuffer;
    },

    /**
     * bytes -> hex string
     * @param {Uint8Array} bytes
     * @returns {string}
     */
    stringify: function (bytes) {
        const hexBytes = [];

        for (let i = 0; i < bytes.length; ++i) {
            let byteString = bytes[i].toString(16);
            if (byteString.length < 2) {
                byteString = "0" + byteString;
            }
            hexBytes.push(byteString);
        }
        return hexBytes.join("");
    },
};

/**
 * Translates between utf8 strings and Uint8Array bytes.
 */
const UTF8Encoder = {
    parse: function (str) {
        return new TextEncoder().encode(str);
    },

    stringify: function (bytes) {
        return new TextDecoder().decode(bytes);
    },
};

/**
 * Salt and encrypt a msg with a password.
 */
async function encrypt(msg, hashedPassphrase) {
    // Must be 16 bytes, unpredictable, and preferably cryptographically random. However, it need not be secret.
    // https://developer.mozilla.org/en-US/docs/Web/API/SubtleCrypto/encrypt#parameters
    const iv = crypto.getRandomValues(new Uint8Array(IV_BITS / 8));

    const key = await subtle.importKey(
        "raw",
        HexEncoder.parse(hashedPassphrase),
        ENCRYPTION_ALGO,
        false,
        ["encrypt"]
    );

    const encrypted = await subtle.encrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        UTF8Encoder.parse(msg)
    );

    // iv will be 32 hex characters, we prepend it to the ciphertext for use in decryption
    return HexEncoder.stringify(iv) + HexEncoder.stringify(new Uint8Array(encrypted));
}
exports.encrypt = encrypt;

/**
 * Decrypt a salted msg using a password.
 *
 * @param {string} encryptedMsg
 * @param {string} hashedPassphrase
 * @returns {Promise<string>}
 */
async function decrypt(encryptedMsg, hashedPassphrase) {
    const ivLength = IV_BITS / HEX_BITS;
    const iv = HexEncoder.parse(encryptedMsg.substring(0, ivLength));
    const encrypted = encryptedMsg.substring(ivLength);

    const key = await subtle.importKey(
        "raw",
        HexEncoder.parse(hashedPassphrase),
        ENCRYPTION_ALGO,
        false,
        ["decrypt"]
    );

    const outBuffer = await subtle.decrypt(
        {
            name: ENCRYPTION_ALGO,
            iv: iv,
        },
        key,
        HexEncoder.parse(encrypted)
    );

    return UTF8Encoder.stringify(new Uint8Array(outBuffer));
}
exports.decrypt = decrypt;

/**
 * Salt and hash the passphrase so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} passphrase
 * @param {string} salt
 * @returns {Promise<string>}
 */
async function hashPassphrase(passphrase, salt) {
    // we hash the passphrase in multiple steps, each adding more iterations. This is because we used to allow less
    // iterations, so for backward compatibility reasons, we need to support going from that to more iterations.
    let hashedPassphrase = await hashLegacyRound(passphrase, salt);

    hashedPassphrase = await hashSecondRound(hashedPassphrase, salt);

    return hashThirdRound(hashedPassphrase, salt);
}
exports.hashPassphrase = hashPassphrase;

/**
 * This hashes the passphrase with 1k iterations. This is a low number, we need this function to support backwards
 * compatibility.
 *
 * @param {string} passphrase
 * @param {string} salt
 * @returns {Promise<string>}
 */
function hashLegacyRound(passphrase, salt) {
    return pbkdf2(passphrase, salt, 1000, "SHA-1");
}
exports.hashLegacyRound = hashLegacyRound;

/**
 * Add a second round of iterations. This is because we used to use 1k, so for backwards compatibility with
 * remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassphrase
 * @param salt
 * @returns {Promise<string>}
 */
function hashSecondRound(hashedPassphrase, salt) {
    return pbkdf2(hashedPassphrase, salt, 14000, "SHA-256");
}
exports.hashSecondRound = hashSecondRound;

/**
 * Add a third round of iterations to bring total number to 600k. This is because we used to use 1k, then 15k, so for
 * backwards compatibility with remember-me/autodecrypt links, we need to support going from that to more iterations.
 *
 * @param hashedPassphrase
 * @param salt
 * @returns {Promise<string>}
 */
function hashThirdRound(hashedPassphrase, salt) {
    return pbkdf2(hashedPassphrase, salt, 585000, "SHA-256");
}
exports.hashThirdRound = hashThirdRound;

/**
 * Salt and hash the passphrase so it can be stored in localStorage without opening a password reuse vulnerability.
 *
 * @param {string} passphrase
 * @param {string} salt
 * @param {int} iterations
 * @param {string} hashAlgorithm
 * @returns {Promise<string>}
 */
async function pbkdf2(passphrase, salt, iterations, hashAlgorithm) {
    const key = await subtle.importKey(
        "raw",
        UTF8Encoder.parse(passphrase),
        "PBKDF2",
        false,
        ["deriveBits"]
    );

    const keyBytes = await subtle.deriveBits(
        {
            name: "PBKDF2",
            hash: hashAlgorithm,
            iterations,
            salt: UTF8Encoder.parse(salt),
        },
        key,
        256
    );

    return HexEncoder.stringify(new Uint8Array(keyBytes));
}

function generateRandomSalt() {
    const bytes = crypto.getRandomValues(new Uint8Array(128 / 8));

    return HexEncoder.stringify(new Uint8Array(bytes));
}
exports.generateRandomSalt = generateRandomSalt;

async function signMessage(hashedPassphrase, message) {
    const key = await subtle.importKey(
        "raw",
        HexEncoder.parse(hashedPassphrase),
        {
            name: "HMAC",
            hash: "SHA-256",
        },
        false,
        ["sign"]
    );
    const signature = await subtle.sign("HMAC", key, UTF8Encoder.parse(message));

    return HexEncoder.stringify(new Uint8Array(signature));
}
exports.signMessage = signMessage;


function getRandomAlphanum() {
    const possibleCharacters = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";

    let byteArray;
    let parsedInt;

    // Keep generating new random bytes until we get a value that falls
    // within a range that can be evenly divided by possibleCharacters.length
    do {
        byteArray = crypto.getRandomValues(new Uint8Array(1));
        // extract the lowest byte to get an int from 0 to 255 (probably unnecessary, since we're only generating 1 byte)
        parsedInt = byteArray[0] & 0xff;
    } while (parsedInt >= 256 - (256 % possibleCharacters.length));

    // Take the modulo of the parsed integer to get a random number between 0 and totalLength - 1
    const randomIndex = parsedInt % possibleCharacters.length;

    return possibleCharacters[randomIndex];
}

/**
 * Generate a random string of a given length.
 *
 * @param {int} length
 * @returns {string}
 */
function generateRandomString(length) {
    let randomString = '';

    for (let i = 0; i < length; i++) {
        randomString += getRandomAlphanum();
    }

    return randomString;
}
exports.generateRandomString = generateRandomString;


  return exports;
})())
    const codec = ((function(){
  const exports = {};
  /**
 * Initialize the codec with the provided cryptoEngine - this return functions to encode and decode messages.
 *
 * @param cryptoEngine - the engine to use for encryption / decryption
 */
function init(cryptoEngine) {
  const exports = {};

  /**
   * Top-level function for encoding a message.
   * Includes password hashing, encryption, and signing.
   *
   * @param {string} msg
   * @param {string} password
   * @param {string} salt
   *
   * @returns {string} The encoded text
   */
  async function encode(msg, password, salt) {
    const hashedPassphrase = await cryptoEngine.hashPassphrase(password, salt);


    const encrypted = await cryptoEngine.encrypt(msg, hashedPassphrase);
    // we use the hashed password in the HMAC because this is effectively what will be used a password (so we can store
    // it in localStorage safely, we don't use the clear text password)
    const hmac = await cryptoEngine.signMessage(hashedPassphrase, encrypted);

    return hmac + encrypted;
  }
  exports.encode = encode;

  /**
   * Top-level function for decoding a message.
   * Includes signature check and decryption.
   *
   * @param {string} signedMsg
   * @param {string} hashedPassphrase
   * @param {string} salt
   * @param {int} backwardCompatibleAttempt
   * @param {string} originalPassphrase
   *
   * @returns {Object} {success: true, decoded: string} | {success: false, message: string}
   */
  async function decode(
      signedMsg,
      hashedPassphrase,
      salt,
      backwardCompatibleAttempt = 0,
      originalPassphrase = ''
  ) {
    const encryptedHMAC = signedMsg.substring(0, 64);
    const encryptedMsg = signedMsg.substring(64);
    const decryptedHMAC = await cryptoEngine.signMessage(hashedPassphrase, encryptedMsg);

    if (decryptedHMAC !== encryptedHMAC) {
      // we have been raising the number of iterations in the hashing algorithm multiple times, so to support the old
      // remember-me/autodecrypt links we need to try bringing the old hashes up to speed.
      originalPassphrase = originalPassphrase || hashedPassphrase;
      if (backwardCompatibleAttempt === 0) {
        const updatedHashedPassphrase = await cryptoEngine.hashThirdRound(originalPassphrase, salt);

        return decode(signedMsg, updatedHashedPassphrase, salt, backwardCompatibleAttempt + 1, originalPassphrase);
      }
      if (backwardCompatibleAttempt === 1) {
        let updatedHashedPassphrase = await cryptoEngine.hashSecondRound(originalPassphrase, salt);
        updatedHashedPassphrase = await cryptoEngine.hashThirdRound(updatedHashedPassphrase, salt);

        return decode(signedMsg, updatedHashedPassphrase, salt, backwardCompatibleAttempt + 1, originalPassphrase);
      }

      return { success: false, message: "Signature mismatch" };
    }

    return {
      success: true,
      decoded: await cryptoEngine.decrypt(encryptedMsg, hashedPassphrase),
    };
  }
  exports.decode = decode;

  return exports;
}
exports.init = init;

  return exports;
})())
    const decode = codec.init(cryptoEngine).decode;

    // variables to be filled when generating the file
    const encryptedMsg = '2f4477c0a45d254f8d52d1b40563152bec9a79f314accbcb069d866a7b7d455330e100442222bddc8db373437f3882f9dd736deda7679643628cad250778430af5757a184ec8932cc14993990ec669546cb194df9b105d90105bbdb046d677cbc59fbd02669eb7ce462fb2e2f3295bcc670703726d89576d2d5da5259e2b80133df20ffa59f946dd7643de3d6d8bd9508d9c4b9157f81648f073744b6bb476d0e82b8571e3033a92658dcd3bfb45ff71aa645aae786c98fe77dff4a6ecb771ee4dad39d2d1b944599ff29ab08edff6e72a07c46c209fac8bcbc17a5348c6546ac854810cc8ee886e54b91be911912492e2b4c1e19add2fa1ec35b27d8254cdd1a834b7d5cc5f4d328b26139160f97c65a071c7bec19a41332f329798d9bba31df53f840f6f9014d0088a26868bbea1496293663379fdec5379d3b6ce316c2367f239977fd3bb6bff9ff6c90f813a9921e667a84a497cb001ddac343d913829f5e8bad5af3d60b30d710237fb28ac22d732b6b4cdd70c5070b94c29d8207c7d19d3ebab8f5c6d8872a4b7318ee359c906c466712b25d9b34ad5ed5fdba73405a309b6b3a69a07208d0dc68e1665a23326d8149dbdb4c08c4c98395b7f5f64d832885e269f51fe434273f9e8957c2c9ea82b9e0965b6c11743a8a2b117467a498ea2ca817bdd2081f090727af1a5745bae10b594a2b6b8e199fcd52ed8c45b7f4b86800539678a90f3046ae680e7178fd86a1dfb523aa8fb250759a9b1aedb1fae5eea5937068db916e91f51d44e7e9ea9e63e0a20b01f250546c409a62103c0a90e7be5e35781b389b036a6b9b1dfddef0e6c8af322ea022f3ed3d71be15196e38ce2045724754cc7ea930c78a2a6e58bd14a01b02e6c56f4fea481294afcba3be09b03e53307e6edc2f54113d01c0450a10ee0e104377f1f18496fde9437c7b017612ce4e534b6d020136e799dfdfa9d2d1faeec5ada5a94a479305dc665ead4318bda96ef0a0f5c32c55e21a45f1e06a5d1689551c09208c928683c906f5a175d9f02d12b08c13978d2c4f5d26c8614457b3066edd1c6b5069698e314aebed8e31f9f00aef734d77a865ff938d6c787aa38a4cee4d359f9574bb0c77decadb231859781c8e8f631d5cecf1c389275504b3aae82375b77d81486eaebb7db7c0d4c3ebfab998e1269178f0d0eb1ac1bb4080e3af7557b7914d1dbebcae62c5133efe94884ade22bf9484179d90b40e311bbffb7e0029686405151c74e7bee590c9d91baa140a5a1d6bedf9a1b7e89e118632366f6e58391c98f28b77b80244d6e78c24ba9b83bb90427ebc9c32094d90bef185f187b5af29323b43052288e1dcc0e44f44dcab05144ffc82702fe9267ef9dfa83205741e2dbc410de2b36ffbf4b7aed97b245d8fde97ea9e25a4677a5ef8537f05c4e8e299dc26059ef3e8254bd74b410b74987b77fccc50b0731f0c3dbd6fd44888e55189bf59d8a26ac0e5deef6716ccce91e0b4cf2acfd577977add2708ff8c7c0a0ef7279ecda7ffccd8427c7d6f0dc56234932a6985e246deb31ae3b59fb0ff7fd279dbe7313705c6e8d3df5cd7a0cd1643067597d2c7277e741482da3fd4be4b23507d8277d075b86803fb335973e034a3663d957d942bfe71ee1df74a6b15fcff761edd5f711f8129bb099426046f712bd08c407435c3ed04d9952bdd0e3d2311e734e65390821f722df4013b70fbd9f83be3ed6bb394a8ca2ec4e4aa9b005993e01ecb7eaf5860f02706272e5cbbadfdc6caca231459a6d75e16b75dd2f2248a2276838a0fbc1d410fd6fff78af0fc8b5c42e7f834f77a99404987cf5aa71bb13d11bacddb8cb13690b707706ad522487e7c0cf449e14ce2dfa8c6e7b627aeaa28e7c4c09531cc293ec0bb10cb34920f8fdc7203f5ff9ba7d233a6b25dcb74cc8b03f041de2dc012f86d996b5186e2805948091fc5ced35facf1b5e460cc9b1633fc3028c41afbe4a801cf80410d6e60bb77febdf20c56daf720ec673c2892f7b4850d5919f89e3dca204e821f29f258e595bf23ca06163e0bb650829bcea954d86b35f2c934b76ee948b631f5942a2177c58327d848a991b61b991deca3bf427546c5abe2a893810e34f222b4cd88ec162d312f094be87d415ea26eceebcb5aa57f93ccbbaee9219fe72520f0f46912a99dec548c335c0f39dc8b415afbac34822f0194da392076c9b52c98451a5f389079fa26da9cd20c789499d1e5b9706d330eae6704c2568ac5cb98e19447552fa0abf4b00b3b40bd0cb40bf3c33572b3c61ebb2b3e1885a7fdc9d2cec9e9894db62529306a920c441ca732226e4ab51e06a06d123316450bfc49b624f703844f74b64c32dbc433104f2e46e1abe8a57d31df97558461bf5419bf0524521bfb4729aa690a12d32e8e8266c9f832e8f3067ccc1b8a1db76083eb722c732952be5e9d60393f5a16b6c4d6337fae0cf5e41c547e144562794035d45463860f9b3ea9723e8a7bfab7c6910ba60be5e31ce674c8549f77e35ab82273b98e277d75f5ba0a7c6246085728526e0cc5b18f52dc31579bd3b98ec634033d395c787418a0a4e5be62091d98c1d5b5f6a12590d1559a059876dfd6ae4c0f8591b28cc97a800498c1708c9f946b4f1a4cf2bc420ad774638102dc06294977abd0f6beefe43b9a7f8200f9f6b689f7a5a81ca5c09161137391d0a4798a3e15c58e3eb73fe1186ba7c16c042c408336b756176bc9abe448e5b544a10f905d73b768063875650e0f66323ae60b4f6f90a06bd3185358e4d5f1373cef2f0ec8e308066e4cbdf33a00cd76e7f846c339ab04cf87da1aea1d9bfa3be7590321f480d287ba003c090f4205eb5aca66fc0df7b0e7efcbd2a306bb830e7b255dbf5949ce9d7c9e2bf087383946b912efc54099809606a801e2d36e5d26b05b9d8bbacb7330431a9f39985665cc46f379d7b6ceb77e8a37cf5735f7ee2a1450f375e01fc79639c5964646d69262ec74d5fc75db38fe9e4dc973c36b1286826be0b113ccdfaf6431b773d7175b9f25065fa9dedef3b591b90792371658112694499291c1d0256e1a8746d574babb63eb6e89cbb9186b65ad3cfcc210c884eb3e7be7dbb389fdc72912a0ba799437a656b5b4e5e9d30cd3c1c1ad10825f5ff406a079ba25d205ba151682f2872aaa83436b24f0f00f06fc466eafee0e3d397027823d65107a73e4328246a755e75a14f1b21f490b5f3ae65fe9c5bd50d9e2cb879fce9d77ddbc379cadd1b52866a7cbff38569301abea09fa2cd48ace6452be3a0a70afe7d6e0bbb7ca3cddb52c34a6cf92bf8e661588dee12a5a18df984bae0b5054ee5b0dbaaf2b0db1c2d2eb1a9bb165baaf814ef452ccdd2f88ef761b823b2c330879cb3b428374276fb78b1a114561d0e052d81035fa8318a56be2f97e2e7e3764c534011b3ce9fbc02c50450a94b5ec799756bcd310dd53dd8e716f5f6938528d39431887ff4b69a8fa95845370b7c5160e83d3b5a1ce31b514c273e01bc282fa8820042ffb1a64b5ee6c16808ab2d91f2daacc72d8c087bff35c9a47bfd2c79e7af8e07d5b3dd98395512a246f6bd93351a7a8d1e199fa824aa8db7a4c1b08b19d84ea1796a56e7549b29757efa8cdbea0c0ab3bee3bf7801f195cf8be9152100e2655eb71bf82f7a80c28e53df3394bad29926ae9207cd0fc38502c218c07a6bacbcc18e5d62c0e297d907f0abc7a1644f4dd8eb2c6c3b7b7e21d7d9e1ab8bb437f857ee83c78523376a4b06b78fdf362ec61d1149115f0f20625d09503f5dcb350180bd310341a41d9209c048fde2da7250e3eaf8efa9b4889eaf4101b780f77195d16f4c975d99ba2b07d28dc7bab782cafdc02d0a754831f2c86e79a657b27015063b9df9a6b39f5da6ff0f8d3dbbb198e3326587fc69aea292281a6889bb93a7d99b220d83f93aff33a579bdbeff12640914668ead26718fdacae81c5787a8c9e6ea409e01ce38c66e5e53e2e9b88a3415f0d1753f26ca2aabc98271fa5e1db34f24e59caaa0958490ef2cf6ceb749aa1e58c45f3c2127fffb428d26804f23d1979ea8d1311c5caee54c33605ba608a441031c2fe5551d00d9c1147be5517294614accde42dc9a4cce90738c867469b03557462537df42b53c2bdf9451c27bcae6cead6db747581cc26dfcc9f79fdbe422aa5f40d501a40d2fd747c6122cccd4a4fe9ac0ad67629f79db643f97e79110ffe9dff30c6c91d9fd8d6349d9ba2be75372f5e421bbc687c52d6207c30c6fdd6fe3b1c15401c91d82951e8bf9a92131081baf8abc4b6a135771d68ce87ee1188fbf7aad2800e219d9c09068442326a7dede9d4aa8bec4dd44c3046b6d9f6360631c070be4025948cf2342c08145f545589cc93ff9ac2da34a45e34d50941406d2331657a8e207aca566856e70a8b54a5dbdc48acafc3972649dc5e2c75a97da9418f80e653e3e513efdc776b5bc12ff191e25d0f41e3efe5d53f4c4fb59042c5083fd6c8fc0b09212b684af48b1502ae6d36e2eae28f90d687bee8c5e2430ead2c3484ae6754c0f6796137aa6b59cff709615e16b78c66e5af11fc0b3a295ef0df9ae12f080962e2c41dee9cb54a763d1e9143d086bddbef2128a8615f5c78a193843d393f50329aa122aef9ec1eb5a3d0f832bca8cfd61a223922089032ff34bc707534150219aaaf2d07d58755209ec448d019becd082d081ff7e2ea7e9b508975ede298b4c8f3b8e7a252ba852be3938c7224e9ec6d697009a951c427d42a70900fdfdeeb7f6c3d442e6f02117d7f8014fd9714704e8decdcd3eb102afeff9a900f1922f2d4316149e7f8e26def60a98f192f9333a39e2e9b3c6236a7ed9df2c82d0ec1fc79b4d748596f2d97e0f2612db9e57f8cf2a8bd1baa5d497fd85bbb2eb78beff46ead1b49447bdeb6e7ab81e90b2239a049b7ffde8ff3ab2b80e63194835397e932e274e288ebbb39a5230b5b6a880e0aef735354960cd925562964ebe84d7fb63c13067ac795056eb1eba5dcf4177ec30a0e6dcc766ac3ea4fbf3ef76401c5d6cf414b5fa0c2ba5b7e9dc0e02ee846dfdd2b3592a20e8eaec8d902a06805378409fe9cd8742d84e90ce295b88e48662b1dc69c4e5838911e5a4554d6951a1da941a87507d06d1bb619be5bda1390b1913590e2f2bbaa007e82bffa90468492451a82450890e59c13c4886bba1a46f337ad5b49f2711f345e5dbe6c2e71253eb1377590dcb277310b208f8b85fea0996af4142dd42f9f1334137741415c74809c81fed7d540a6907751f5a5ce9bd501be911301daf7663242b00c4a4f96f0e8e85377da19b944a7aad5ca40ead3dbd825fe126f573b9b76f63ab5288208cc6beed7b7a244c00c51d89cb21e4e4366f796e5e535ec391e4ecf9a5bb0057c3440555565a8fc5a29790bfc6cebbd5b1962d1b5895412f92cdfac319ca161479c17b2791995d655269eb4990de43ec5aaed7d2b26d8f38248afcc2c17ca934145557112433090ca88f5cbd9c87e8ae6f252261613d93d7d3fd177a425950e7b2c02570e004a1130bb670850f0796739030c266044360162293acbbdf5410c37a8dca5762f065b6d870729da1ba7a6bc0d8e36235dcec79127f000c7e502b66b0bbf1441ed38c06a759c4de52fc2d7c2ee777dcb73e004e15141c0efccfff454a04008db0aad52aa1b10399cc8fde04aeae25e9f28ed6a9762dde46025958c50d22261cd9c64c16afdf76fa0ece33a95799986b2f1675c386aec8e73f2ff67aba21b4e0b2d54cd5c4eb5f644c6728bf1d53ff61c1739228960e78543edce255b48fd8b0672489149633f09ab35d3edb12d3db22d8b33a105425e986d7b8bdd68124c840563f466dcf238d32abd0f64dc2413fd9ba424b1892422a7b4e868be90c2fc7dfb31ad968d9062f7473e3b6dd4fb380db7f08e1c6a267344f7ddefe6b5709523a0b8b1a53df7f7b572169727bb00c2c00197d50d3f827bfbcc89ce2e5279da1418d083bf507f2ec3429f9c9d1f0a0ee20fe4a97bdba960f396a8ac80365943aecc5829359b7dd398063e0b81584734a23afce218e5663479afa2013ceb96d8a8f042b8bbc10c0217c35282a770035726865fc27bc4d22e0d641d1537785348b60871b146ef57996b1fee9d34dd5091e3a6b60910786db260c40084c4b68dbff8b71ddd971d4c26ac4cb8c9b9d40433e3e1ce0e99c75c4820c877fb5fdee54a33dfd97febac6443053fc06b2c0d339ce059e8b60765403fc0333ea6c4996ff3702e1fb27d39bc9f212c63cf93ae87e4286c0033a5c663f7f49083eed1d58ed75580c8223f9011519a9d318daeddcad509aadf82571aa30c2c740420f4ae346b013a204c6a56e0c79ae95ce1d87869f295c5d74aae2ecd3a8ddcf396f574ee574d940641e1f16b417f1cc34772625e3bacfb15c4f35c74cc50c661b33135f841de4d47aeee988befd7b7fffe03ebe4f99f3ecd8090808537c8ac3ab3bf32e6ab927d9a82aee833a0f402536b85292fa65d8ec8e59781f75aac20fdf28fb4cb7fad4620006b173ab80b78ca034afcbdd808e408e2ec36bd958d04ce5238c8ad77ee4e3ad6f08c122637ba800414d955abac19e8a376f71f30fee6584b6d95b999311887b586daca3a7b09f7569a18cb56942c70fd5a54c15a1501953d0df364c25183f86109945548884fbcaae655cfe8de8658d6f3ec8ff375d35c4102de68975c3ab6d4c653c2465f7b79676e5ec4c40de7c867e999a99643dc53cc0426c0d9e3128eda004be5bb61c2ae66331eed6dcc327ea2afdce97f4fe6c33d5194053f660942fb403dbefb7a266d1a57891d79e13f4ae7fd24fb1ad5632df1006e226a5ecb3cb36ed2800cb532956e83f2e62ad60d3dae396987ec677cdcf47998162a7e93502a329c13d8de735ca8bb9f7ac88047b427a0fad7bad80c5172dc436852534772964224ad1e129d647a363a6f8b861903e4f421f60506d390f380b712114bcb7d69dc472b5540ca7959b732a7e5bcf088bbc912cb6a3e6b470589f4476dbe1bb9f106321fe8ddb9fba93292e3e9bbf5b8cd94d1d27843b7433e2ec895cf2319dcc48bd7e5ce5fa7d0302433b8bf0371649aebe1bd5773d9e6a5adf6a45ac37ad4995e5c19f228e8f3a282ccde1c5c9cfad27019396b8a96d41ca57a69817d821d5050557941297aea1d4ed21b782cfb4a868e57cf703bfaac4b498a876d5764878a2404c5b28f510d1451be37efed71833e2078764f19ba4500996b2ebc90107fd0d9ff879db188279f766c0a886f9d2eee2ffd44c344d8ff5e62e7d5fe41d4abecfced9b8df8f0e96927def1366bffc351ed5b0e01edf99600eb10c2a1947ef337f6396cd10b564f58d72e70301c595319e98578475960bc0cafae9097fe100de7fdc24fc15c5737f3a7fccd8c021dd7c254a7d38249788b18b8f42393091755222280348fdc1df5613780eb9ace4a2d2ed7684c7abcb8c49bd41acbaacbc03722fc9290ddf6222a8aa332a233847e086e3aece1fd50b8e28372041fc1e03d42ad646a29965ac41e87e4de9db76f86ce53f578bbe33d30943f98319efda4c3590ffacf00c8c9f716ce0c7c45e34e786d812c8355b1414451b4afb9b8cabddbed3cb70d8ace809edc5822c67d0b1e67b6208f5967d3c99d28e029e894ed487582e9c93730b02bf8a0d0c9cf2a90fbd223e8ffc4740bd6ccf39bc754badafe5183722f8132ebbb96a8dba023a6c68f1b302d12d0aff88dcf4531f0b7a5f3a50aeebc9bb760e89c609966e8b57dc25f3de55d87229a34c346866975db96ccfd13cef4de74f163c2ac47ff311dc6de09a2050251a11ec12e16847a1d2018c496c781116ce1b823b04483a547d112b5adb3ffe1b8f03fe378d56fa5d6e45b19bdf4be9af0a7d05ffdb3df68f06a5eb58cee69905fda9836bb51162c2dde874597aeaadee3e98bc92354889b5117c32c0d2fb0c613188008e2fe9fb03f8c530b4dc1bcb40bed49291612f92a76c0ddfbd0b956328fece76dcdbab22addbb0612bd0144ecf09cc7652280eb122065eb11606904381c8de5ac29b8270ceb0e595e57f6629350e113f548a96b299fdb69571247d466c4864e493b9939b912be91d266865cd4a8d4621ffb2431e83b4b047313e12537906a2081a2c6ca66eabc61d39098cddc48f6b73c96909abcbcb2c6f3001d601c0302f2dfdadf0239b9d419cda27a3c165f764cf334c188bcec9ed4acf851a391340356e9c2958203f4b1c1426f916f7e3236ea8be6346f4d3999c147feb65709397bf66d4f1a436fe60f4687918f4158ab5a99963dde7816707511304433ceed2faf1eaa21f87df5354579ec10e38702635e8e4a8d7a46c5f16eb079645a06ccc5ac941c9db186675f8f3e510f877b26a523ebc2b8ec32e1962503c918ce7345f1117de9612a191cc3057ecc8efd73ad1accc3db33bdea56763735c3ca751195f24911c1d679dcbf3f5ad51419a47d301fb2eee377b4d84f37b45b79b767d91bbbee9d3360dd2e82736835d0ff41d8901293357077295dab44f59491eb7d188e231b7937059d0d92335b63475ad73c1eb2e3ffb106150aa6397e8635c9c2008367164343182fcbb9cbc240508807ab5604fba92f846e5412593940db960161e4465f74d844e9dbcce16499d28273dc91ab332e31a77b9a6b3bc1542403ebdd0bf31f36f663f18351778af4e58a7428cd7a800e80a4345c7458763c460ad16a22e1f3341abc2a1b481cdfde871e78b95e82bdb3a06f934158652fcc3d1ed09153128d429e25f30b7154fa35789ed828a92f460f2adfa27b61188d185ef0d23371772c312c55bd0b269ccc24b2f93551ae1b5cbcb9039eef717c3dd8fd429333a935907e98f4bd07dbe56730b54c051252381a01bf8bff836cabf7eee55478835b33da56fb687780ee63eede45b167b3cc16d14f497f18551f588eb5078cae3fdfb6c7f94d3c03af08c516f8f061560257c7f7645ff03ef357d562d198d794284593c55fd1e984f0a93e0a0080627b0c2e06f9a966dd7f21eca4b81d2b83b27f9ba4d6df952dd1a80e86de69e22c6452414d060ac71129aeb8ea667cb7428732c08613f50f67dee3fa3cab9ba3bd772792fdc3aaf7f71faa9840f2a20e9362d7030526ed6f0d70879dc901a5787cd47f1a7e74d01f06dbffde9b9c2025ef93a5db35888b02b2c043c5e2bd00654df2b7666b383427be49da2983ea58564ea71a9f6b9348e15bc3e985ccfc30f70dbf06b37efafaca2301b919348bca192ad9630f6c4918124c23c4d92ddef628aacd266831c50d4013cb7250289c97158d9d5db38624e9ff9038cf650387e516266e205fedb0708a367392da5b89478c5ec7febf5da96aaeed1499f7f659cb1ee88061b7b4895dad43f2eb60a103f5ee6e9d8c0e936361b71c87afdeb6e5eb6542d4496e12e7e8e71f1ef4cbf8069c7e001069ae5b1bda4ed2c978fd27ff849f0d9662ac8d22881b69db2bd7da65c31c4733a6b5e4637c9e69246f51b416b4cbae2fc53dd4c5ed0836903a869c3124f449bcfca263bb7c0f5b243103f9c70eae0b0e2a454a4bc73a0aab9c07882a33320e94a7bd3c19b43a6b6d94146e6ee26f7f753020da5b0cceac9058bce6572bb11fa0b9e61d8445582bccc12ec37449096e0c862b190e09ea035e443ccd19d1434e1237e8c406b1addca6fe9dc290b7c58201089ea60311e9291bf6e13000b9ae2fd3c38fb227070f002d9e616493fcf142756a55eb6a3b474c4f6bd41edc8a3db4cf38dd6b483b52e597a45c507b5ce354837fb2603a0eb8c69aaea5b6a28b740d33e990ce5b2c96afbdd8c7baf3e6621fabd7a1b803ee2d0a2411bfdaef53779f570d5ab8bc34f62f57e029b1f3964e6c6d0192a1efb38e2f3ef75db015d678dfbd2a281ecbe95d50dbd2edb7ee332079630c914d409c6ae6bc8c343dde4915974376be530d4aa55e79e71e237db62a415fb604528b17f9c6e3f6379e49ad50d776ca3c56d393c2338e839f39eb1811d4fb853b08b2ac374f8e6e52afbb12b93eaef21eea82e36ae468c8d360b89e907c59a001a54bd5ad13a93271c8e18463771a01e95485d15b90f4b710cb697b4bd9187f70f75d1925486c755035c850295cb051f8e072afff80ecc9df4f504f5796f913e32083336a5c2f20bf6287d017ec8959c53fe0db5c47a7eec54a5201d64be96f042e7c638077260f6a699cffb03e4679a14f3ef68a04e4ed3bd121f3a469f23252d860064d01b7396467c83ca86d6e62210a02744762a81eca7fab24abddea701480353398b768ca529113d3b0f0b28a7a9aeacde1ab7191d67d77fdee4143ab99ae258ba04a487bb9194014c5f15320672ba2ee9e3d22331be3efcb419e42f34265ca4278771eb829ab8aaee821315fcf5249c0f0b8269efe0b168bbb7f3777ac3f711c2008bfb619b59c46db5f663b8f479bda8463aa564235f972ebc0a4f389ec4d143d6e7351274cbc4ba8c892554728a7166195e6cc1da953bbd27cdd68db7da49b8d0b6a1c20b69c2585ad48220b0f1cf8191ac0531e2db21d62c74ab7a0f48f45b6e08aa6bd7c0bdce3173eedb221269a08cb79fe61d144446f8d9c68862c1d749e365e0a4fdfdfd5c2f2fb32dbcaafc07c5d88a7e98a0cdc0f3dd1ddb3deb51300253aea85b172696e78ca0a0809929e454c7366148b3a39f141befd56cf576cc80cba5ec428b8084c2bd0830fac32cf61d5d73ee19e0dab5d6dbb1e93636f68f981b1281f9153de97941c0188a7b65aa938c36e1d6b67912b1007dae0fe8e71ec3a91a72d38fd94613706272305ea4bf3b31985e6014389e2bdb1ed00ca0af6c172f342ebc9cbd49457fe4fc7c2d52e27d3882ed7848114d76ca48d9879679441eab092a7bb3b83fca77edee4adb93f9dff4176077fd3b734678115c757e940f1ee18df45027a6b8dda092eb8561d01c3a4150ac5f9afbf7d1fe2c592bd79c8ec6ef7ba153c66875952b52be8f604abd47afc2915ff8e9d449f38ae56904682a80fd8e1ae747a0a1658cb7a2dab36cd5ed7a9566447b4ad3ddf9d42026136308fb3476f026a72597ea8542fbab962f51a8123b64f9009ea52d0e682c28bf2b0041dc0e18eed7d0d42491e46f3d455b1031c7aac60f6aedf11423a0be486ad8bade6008d87d6ea4894e625d14d142633d09ac7a96bd45de3b86e3ef124e21d3f898f8e59c3a9fc697dc7deb762dc5b6042ee1ca57a1346d9e84453db7d375f83e50a46ca60e9955b40cbf827088851c3f92791758ece04151ef443eb8aea964e9157bdda7c69c7bec8760bb039d2216bb8e9b01bc7a1c9fa26b59e762a8664745b0a04b4baf6dad8f4774f385f18869a99cd522253f82e436e5303ded6d8346d839e81bb24ac2233bbc97a2dbf8397d7b65144de23faab78bbadc0f0fa224f2b2b072c78de3ed097fb3e67b1547cd5af81b5a1c97f433eda825d7e84409507fe5c617f48b308887939a04b358dae7a7c905b216792aa7c569fae72fd3c74f487aa7dfaffbe51baee1bfe7caee546060b12904b08f933b92e3ef262d97403ecce0031c46a5b2889aef0908cc21a90e15ffae873b73d58832423c8183a4ed95938b1f54127bacb64049fb3b6beb8585d9ea519b1a48cddd529a70b7b5944b30d9dc654232f973d7fa836c2548f563519261f3f4bff8a1a3a21eb1a5d63940b8cdd5835b2c3acbe7bd59a40d1b7356fda9c375f1611705d9874e742ff30d4affae97a0af9ec00766ca9a4d8329f98613aea03a67cb5cd71d378be2ad81e0a88c331db6fb157bda62986b7c99ecedb4196da5c2b90023fa74f1a2933b760a801331e89da21a740d2b1b39721c795ee42a91239f2823ecd7b5502629959ac5e71191eb97998b05d7a4c8e79252c7f4b76bfa57d63907a2e4c03782618e612236300e553cf1cb03bf244b02f1cb4edcbb6741b6efb011670b9ec6cc463dca0d5e21520aaadfd0212200ef503c1e658f86e72ac379cbce4fdb940385e298e6c37a983d8d281887f99bdcb281a0493fe8849426abc67aef96f557aae49697875fcb480fdbd2ba5823fce8ccbdf6e8af548a8611e10e40ab7c767b824977733f9de620c5ae9760276edc3432e0bc7aaeb57eb8b8b6706c97ba7396f424dc7b41895ac8ec04de3974d05c3e733a539186c19dc326b26db33b0c151f5714c22d09fbb90fe5597ba3a340006444cc74eb404b6b396fa1c8261eb8bc171e804d7b00040e90b557673bef950f2eec94d843e27506bde8a7d5844b415db1b71361ea7f9ac02587b6b27d819edd5c4902fd20a073ddcc5cbe4572f3c8b0e622434938465259a426bc0b5b7e4a741f06d0cfb42cd8a9f7ef6ca283ed86a314692126ee16f1749ab9a24839feff3d36f941b2f5c8a537e98787f8b6a0843774483eb05ba2761d9af20a7b3689c1d8750636b6c9d005b8a150cba2db5c542d725e1cd54cb7adbf38ce9b9a04dd622586b20bcdb58ef873e0856b906d3f2db81371195a219037bd72b286464ec13c7c0c6eda02160afeb8103bbb65423f8215c9d21d42c2d7c05956b85b3fa22b8b3c627b3f29314ad185e58d8e40d5e8ce9d71943e0fd517cb9296b34edd23f4b0d159551093b7d172d6e172414214c45ff9ed6197d9ad662a9e63cfedf6f9f82fee96ffbbe0f9c0c64576e1a45904bc27b4667820d2292a7cc47fced4b2908e5a9d8d6a502693f27e8d0beff98d782bea3a8edd96d6a126bd9e3b07cb2d8d531c7363fe811f0c45e73922d38269fbba8b0e5c4c6cd5904f88553f10cc0a40d0332dce92b39d8023b3ce6b36c7964a251c6125f672a20d8ecda7ebd0d5f2d870e97567e290da4554ddfa5c255c65f15692669c63c2918f98a0912ca7908f07094e6a3763910e2bbe94ee9b6beb3e80aee6479622fc6af8e1ec80be75e6b11ff0ec15bdab6e19d16006e25bc35e9856db4b3da5064d675bf52e32e2aa91b2c94a193dc9fc00cb79d56b0c3c40769888ee9ce32de7b42112c18dcf92c57e9e3c2b549fa52d16b6c8412b00aecf1f915915b19536ad9cd02dad57b6dec1f939bf1a8ad3f1fd667485905b3e8ee7faf93f32949c429ef1132fc077fbd0a6e937d43b35a241bcc29d71fc45a7b8ba17c03181d282bfa05bb28643e4ae7099a8d62d6fb2aa85f66587a74ff98c09dcb395dcde52ea5cda6334d0d48d5f640e6ab4b1c8c9631dcd30557f136ed0d90d44b3576f858a5835f1d8db881b0a868816fab721791e0d9a1b5bb3757db4672f8cd64b7af91fefb6670d8eb4d3ed442d7d93b5d074e6d175e3f28e8895d63a341d0a62c7d43bc57f6db7d32d57448b660114d95f634415f2644808b49ef616421d3a0cd3f900e83f72fa25fb1766f0de313c50bba0a860177d1db8a6575de3b4d8d1593ab83b5911f0a04af3b7890c76386d78635a51727cfa379d2d519f7a6ebb320375d671545d79f912077a9f2878f3af0470e47e47093a94647d105af1c3bba28ffdd868d71a850e6d1224dc6bc31ec4b17bff9416adb4c8c18f06d0fe89e10cb91ac80e144ca08e6741589999141a08fc61e22dbfb2377b2acd862ceec3feffe27d7d9e0adbc5fb1521197ccae15b1e53bc8ca651cd36e5d7c24307f716096907abcf8b05de369d2211ebfb8fd08f1d73d5a537a95a82aa4dd03e4ea0e644a54d8f341cd8d59d05c91a0311ff4c5358bef8498a436329d0ab294c3f23975d38c368107e92093377407b53057ab38e333b119fb64bae7382f485afeca9226f1d24fb2ff5639d46d665aa3ba66d0499403073b6ff80720ab89a93770ae39dccca80ac41d68c2a1fc3b8c9e96b9ab289b486bad43a853c5b708b4ea2590924e09c41549b12858db21f68fcd41ee552bfc8c239bae858c9a047341c009da93e09e8bb213a398ac69d637764d2b749a1e74ac0e9345b74b70f052b86d2e72010f47e5b27b08a0984d57d96da29fa1e73f59c5812ebc6258e099a41d775930397efaa5d1e55b1edaebde79c8918203e0a3a1ef56802910f7941450eec011be0d5abcb1301b48874e8071c59d0e97fed0e9e6b35756a2e2bac92b8ad9a835900164525d86a19973ac0ccd3a5c03c992e9c302d7c10c4ac564ec5b2c1e5a32c1c793936b2047b330d037c25ae356d56fc1db35a716409aed0ad0e2608ab6542af4ff45d2c2f85da4c729ddf0102f95919de7ffbc0cc42712f1bc7bf0cf75e31e04f342acb7861cbc6e104626164c9aa5520fe7473df2731538d934e8d381d175fcc31f5a62848b92fee59d6571276df8d76fc7368acbb78415e4af7d6a33358f6378cb4ac1b89adeabb82a5f41c5359cfa7679a0c474cf865f513d09a0f9a95e17f6ab2fb9a7c6865ebe5484dbab4a4653ef19de61d6c8bf1c5913a60a39f9eb168b514f6548fb998d25a00454163f202f3cc41f2e9b897ef715cca76b20264b3484159fc1d4baa0e5c685da1235c202ccf5e3642dfd667e424f2f27f17800937a78311c3a33dcf44f24d1414408b55ec93b1d66b1138a79042bb56cb0760d421e3bf1017f7a8c936cc3df1ac6335734bc03f2926fa171f198fd7f6ed45991f8bfef3fb85bd0e087ccaca04f2dce5504fb7a96a776e176de78405c1a4be766e766cc2527126fdf3d013519b32e459c111ab21cd8c88c6d6052e1dbb53f42fa286dcc64d780264f48868e4ea82879752f496a0d894631530942ec5b6614e66966029a8cf9086d8f2d0205d8055f53be7472d58cb7e41009c848bb60909bd51be8f23c3dbdf32c55fb2970d77b9f339a1427a81d22df0763b9a041a7ecb371a9e44ab64a31e51a97f66a07105803200e242527612652973d9e2ea54c1d9010de857689ccc7e6644e6041b84d1e49ad0e9b9fb458f3fcdfa887bc818a188b0cbc247f0df36ef085f898dc298138c8d222a2f5686f416627660b36979bb020246d9dbd20237063e603660c46e75330d99c00690fe2aff523ab246b37b3beed5b2f5da419b42e1117d1c3090d4c46450f1e158ae8d2b20ceea68bd7eba2396e484defd9ca3b11f193534b3e00c25a4a33b7e191a711ad7bbf66ec01ccc3d81afbc0e6423d39c15bbe8581479d8fa0d7238d8336a8f30f373d92fa04f927df8d2e1f62ff4219ed13605a51bc5a28c9cd7aebc087bdbd4b1c0bd6166f12a8e51f73cbc2b7f540ecbecb062c91c0eb3de4c7a1dc273f07c41240b77c40be5d7c24bc5bd905cee6ea49a9f5cd60bed5d9abae81ddd2bba9958b71bb884bbc301e88a08bbf4495f469807c066c276b53ff4ece19164c6e374a311b8164a97c82f9a4c90b32e70a342ec361553bbee9790a825fcbcf355fb59bf82ad4cf9cdb4e4afca6c71084c639a25bae0e5625523604959c3968e7479f80a405c9b068ebd5b48e5e086f40082a445bedb082710c3dfc816238a4156f5b600ab0a3a32b7198f012a7b364f14f1f85280dd250bf2ad4baea75b4bc6707dfb220a84d1402eab193da1fdb9b10b976851c1b2c54aaf72b7ae67a75c46f2177ee63fbd2ab532854a278527d610a83b757b95d1822c621552c03d5248fe01ee711f79bb9a74a092cea03d40dd1e85bd5d4bcc7f8fd95efde40a68268594d0c71bcf5cb002f4c9f86f1972868f9d2f387a70795c2fd1d46dd02fbf43d11ec68a9c9c5b3ebd597bd1162a535f54f2f0ba0e16ee54cbb214684fb518735a739733e97ae6bc8e1afe794cec7988358aa97ea24a3777fa3be5a448e4bb66e21805e80ad548ab56ccc17fe92d1dedae8e1db2c306443737843f9bd63a4ae3eac8b8aac6d132c2fac22710775f2c357255cafced030570c530df83773d79b67b6d021cfe44ba896873491d8363114fd84e50172faba049b58232b85725b46ce219abf61508c8fd12a9a2e298fe647002cd5e2d3cc41241cafb36ee0ccab7f27430772716511ba0362881fa47241ad3ba87dbada0156c95912f4ca435bc08df4000afaaa8c73057e4e63c45695f894ad906c3968bc5199e70610baf718ebae2f496e10523436bb38ea21996b86cfaae8b95de1eb9a6bbeba1decdef97eb9a118734d917d87a2625d97b6811d8decd1a8d6cb2543dfa43568526386fd542a0babe78784bd5292d6a047446cc5bf3600800b4451e027a15e95d2bfa3010f5def0cab9529929bea12c4287d0cf4ce3c2b32002598922cbfcb5859502cb0705d8f0a3da21f8b6d5763932fa8553a921eef5b2d161407309e2ea6ec2b6ee7939211f9e7cc3c1d8a6208b4da9db60a2f2989751fa1ad91fb7fef601aeaa0ffa3fca971e6eb465a5183e72939899b7dba5b6a9f6a9a663a0187af04dfb41c15e1cb96b04ae331b15c4f0c860759dbbe0a515439b12a7b3fb487d853f66a54a55d39a30a4e32cb187a038fafd63e99a1cf670b6942da3f60163d17a3358fa09e5e9fc422b307686d2c6d90ba3ceb8ac4c4170020a8e2993cb214785125178c1c905f239511fccefc68ab94921681455aa42f635cc88bc8fbbc5b4e0e3bfd6c89030d4f2cb45a68ffeeb536df7b78bf2c8072992d638a42aa5148e8e9b91d4dba1c6eb6b80545fad9f4b39b9833f04f8a66042f360fd9857d526bd1404b44c58014ff60295b8a51285358677edd64e1a2e0fc9c5f219c0fa6d9234be2e4aba2bbc95b5b10910ffc1406b92d29fcac30865b0ee8a6b73c5ac837fd4af43c3fb1d44b822bc03a61c8ee37965180160ab8bc0756f6e2d7e5a61816ac2cb0c42753cdb9a6fc1d564230778d7db0588300534cd589e9cb07772f08260736e8b864f29df00193d58efac3ccca43be5200daa2c106d187e975a10f6bfc72820c333e64c40d4ab0082d62a87bd143e81360bebecbc46f530b5492703c5fae1b50301c53c2f2dfdb43260d9362be6b8231492c89b9c0a5d9fd3aa22911854c011ac7b7c56a4f6fa6e52050a2e28bdd653efa564a8cd6e420207a529d1742214f4f8f14006af9b4a96386e6c164803d1084fd853d04ab3933b1bacfdba7f8f29fa53353673bc54db6bd9e0ea1e02770239fbb8f223bd9726a9150b87d2444b0a63fa940fde8538672ae8bb25e6a237e059f9671b13161e7e9e8cd5ac8274aec9a3487a24c23fcaa1c8ab5dd1c116b489536ca94ad50ec142d66338367f57ba08b252dd54d57afffa3ff8f03cae99e2e1b8b5efe6e5f8c79e37734861683202bdb4dda1f9b0e083ced5d9997767047956aaf931735fb8bfef91c9b662182044edc9d6256126491f22bc586d2cfd7c13bbe1e0edbfe4ab55b873ed6a7a9ee0a069d95f8937fac54d8160ced19797b0977496af601fbad330d583f798ae74120d1c3f389e5170edc358af5f66b4ff7e7856bc2645beed8b38d4f8db5aeac33c0cd55c2b63a0358dac18f7ef611a61ea7bbaec9e506d587058ec77c46d45691918ea6f5839a417d158772936ce28c4ab3167f3f768d5f77d2ccac238ead9e551d082e8da2d0aeed98223b0450e1cd399f4c4db3893142515223becfa6611357ce24cc342842afe650712df1986ebd08c458a2fc86dc1c065c1f125ca5cc59f06e8d72575c77ca526119fa57ceb949242b1e993860debab2cc6149217ae770bf0984a43d4995703706d6b8c53d43187fb3e62ddc29494fc92881f5ba0c9d8724accfa15639d04f9295d357c78e42c58446621cfe8269d453ed2d9da92f530e60ca2dd2661887e47f7679d77551a4fda9dd0892865021a5d3ce1c18d8535ec9cb195d12e5bef5cfdaeeb502b57568dde94f2f1cee5f5da7dc3daf8d3666b0db9ddd54adb74e25524b08c4620fe349b4099d694e20808e7ef772338b4b08bd9f6aa0bcab6c996751879a97b29ed0dca69c243255c6ba9955a8ac29368e98e9214f3a5da16714e3bee4c4f6486b736da1e80f2b4cf51b5067caec44d7f46e67e04a03bbba0c9683cc2d0e062c8ef9989c7e8740d1af80b81d9b721273e86b8b4ffed659621aac6be674166aa8a0f31c1840bbdad459b58b1bc5684f94fed666a45f1c7d0e0d60807b43fd5c3808d21500e8369df497501c8966fea4f79b155adeb43b2843a9e3a90a1e37b3888ea3f9e4a790ae6deecc2e457de00aa63cca6d65215c070bc2431d153c0332e2e6b096fa2f322590bb738a5db63a69b5ca62d4bd2a7cd01a6dc69382f6ddced67ef17c7045688bdca423a1886df80458ba741b36548a5b18384fdb94718dc80388691c2a25cb1fd2d9bff413fac9872cb936d68eb406cdb503ef26cea78b0a84b02a9687c0eba7f6da5b508c330f20e5246f278070d85dc136c929d5de1c419fd5faf0a345d526aa572cf8831d726cfd86217ad991c4cf1a62736cbbdf40c9aca40067856b1c032dbf165154762f41425201fba6e9acf45d827a151dab5ae426b9dbf96a3726a6f8210ca0d8eb755a8170b23abea6dc98df6f12555fe0a6dfe93c76835c62375deddc40a02e52adc36159ec5eacdc5a2b08c7853199ce5a2a0e24ccea030786f72da22c7d12e1a31995c5aadf93490fd56d1f3bb8ea866748333a57583a25a1084ccf92f91a361a4fb3519a18ec39c76ef13bb1db359345bccaad01b06fb6634dca4edda7230b215959bdbad110948c034b92a606f3d8d10c7f4ed468855782da9f42f855e0cce521177ff72a6e8c02df86e798349fd07e9442b5073420e3e7c18def35c6b78d398160f33565897a7791223f5948b89e5df054c91f3ffb83b549ec0a41e84a0a649e1f0b6cb28aac7ad726008e3c213cc9a862f024b4e9831e2c79f179764b3f2b09490b52cd58a8cc129471991de6126be9a6dd1934bfcdd22edfc85099812244d9f31a5fd6a3b3a53d66d1687c95dd8a804c1eaa711f00e4871c688de41b60c1d7b7d4b79062cb0d83f2faea3ea6c5285d829902de0a758b59e3d18e00c1270b28059e991a862e6ae79710e551a6083bb6eafa9c0565f06a46cad52822caf7f5b961ec9259602a2cbc9a43f4477e4b8f812d576c29f7ad787aff03159cf7aa8ed929efb2d89806b75079c271c9454c3fb54a770bdf5196eeaf29345b25138650061d5c3c4882154f796a16baa4988abcaa79d1ae3d45964cdbdf25eb31c601cc59fce463b69689753a30496f772bef152d2a19972357b41c7581fe10be44894795bd7d7817bbf8ab097482af40f46269f6cf042e32a2530c14d7152599b718612c91190d21f76600b5b08b2c067af0b8b6b97a61abcac9d7b2de297493f78eedeae4c3f6cc0cd2e95b0aa581a6fe52791b0ad430be80b36e5e66beeec221ac4551c787d6f64f8e80fc1547a9935ef3a821ba153a3c1d7e9a7ff5952b7027f0a1223b68cb74ff8ffdc17c8ec0d562862c9a3a284df3d7e87079577185ce790aae8ef830b01036459b165f2e3f882b8ae9d160bc2fbae3352927adc063f8de2e1923a53b3d718a4703ab584bc2779fe54a5a35728d909ae5ea600997c4291d62e40d330763b7af41ff0e8cc88ea008bf2722fe1f56eeae72972cdb955a8559f859fb0fe6db3b93e9ebe8d9f3bc8cc16b4d5e8b8b9d2824bf6fb035aed128a296edd0dff46bd3f07c66c090d36dd731516be76e1013062f3da3d8d18074091035744d3435e67a6fd70f68fa52c43bd9b7b23a582a25e555c699e54610b7b8dd68d8983e21b8a12927f429fe120de41cb0fa7742542fd98472275059f295e5d3172671dbc1da463916fa8e7b42a26905a84062559c8ad2475aa616198fe2a68eeee52fb9274f31319f1ba6e200a4ecdcc56cbf4137a7a76332792347af10a646993065c2925c2b57b79d3733410532e934846af7fe7b93fda107bacb3b0c1d00ba81efbb7cff6ff3bb7906c6cff6b95d5da274f50c754be24f5f2f3a10c3d40c8b61481dbff3dd79a4d00ae8ceda0ce07eb6d8d4fcd6515dcd90fe3c6e8c06386981dd1b3ce14e3d74e2d553b5e089372f6f10fa53a321abe47dbfa178e6631042d03ed057f2c4b76092ddfe8df580a0d619756b5ea96599b373cce3389fb933e88d8e84e034ed4e0649c4d612f0430675236d048eb6c0ab912e3b4c1883d862b2503302ea13f9a33942d8492410487471317373b621e5a217de94ae568f806dcb97e4aef2389841199f0821233786570b0e79686d3e2c34bebab9716526360b1e78d86fa0fe9b11eec5df1ee48e234e468577138af6512576d8db214a98e39b59e0315a39bdafb17890922bf348355aec914ddf03e1ec24d024b8420443622b6005210544b240730729d34de7a6f09c1ecb3b02fa6a01424da5f7216baa54e4afa2ae3db73819838d86d996da01fabe9321f9c0893355bcc928bc0499e374bd6a1f4141a0e8192909a127ccd776df7b98feb705f4f459ab7c96904c4a736fe0b5199524b18973407251029965afb65f7f5b00164463231552d9e672c71ef81c5b14398910a3608e9ebd240efab2930c9c3f55241e901426b4446106c0ff0ef3d11186b1f98cb14373d3f1e378f8aa5e63624f41f4e53103a731c4fc124b8ed74c838923b7507673eb2c25bd4250ca7eea460ba83401d2a8451f1e7442557e2f5a749e8c7c7939cb09b3ae33b398e44f95ec1d3dec58b5b36143f1ad35ef912f5e530416c5bce3ca6350224cd742316e8a5de1bd3486905f6d78c1f11c1af807a30324d45e813012d01a53f1b4c6756739a20c45fbf9d20c9d60ad768cba95388980274ab37541f80a7def714ade3b67b0f105cd48b527c234c3c6cbdaff96143477d916d43576adf86b8b3cbb3c62ae0d4481bc49544a784e7bc336d3027cd9d96d7eab030c41693c2ec6ee65f04663a491b7bb0e8ac876ac43f4943f5793efb2ee9afe8f798cb7dd8f2a5d1457664fc6069c4f1e7ea8aad6ee585db537ec4954c54627c22875a29dbb73436ab6db956898cf97b1fa53afd1f9645b348e172eb485ec84d18f287a4d89a4c9282dbaa159ab95659f83147711f6e08cfd32422a1710f948d8ed5f311329af54bad812363a3b3ad2968111617c0c7a350419cefce6682784520b89fec42b981baec20b0356f57470b5990f0ba5ee5bd4ac53d1f0c3668c798076b8e50b4aeca8dcfb15afceaddeec300f4dfd85b76deeb5bb5082f509189f0e2ca64cfee71d291766e2a71be3216ea26ee2f4d7f3c55924c88d08e9611617156a1b65127be5087d1487e4f626520748cb93aaa0e5a9e21ccaa09cd4533092701e8ae0ac9afe602308ad8c061b03fa70c4dbf9fcb83f06e3b97f613d8850277fcce71d0a123291849dcc835bf80e738bb052f68584a72a38d59ef546d7f7c41e77662b09b2202cc827065738ad5f3782675f6800b81fe0fd1c0cedfa15883835934d4d1722cca8a2887da3e8e9a54bbd2f48465916a9b2a24d52b2b232bf06791e3ccefeb48042bd9e4aaa6360ef2c0dbce4e363d88ca80ee0c2189f194548d7f6a5370d4d2233aded033c7458d9d2e4fb9ff040e8958a509ae755e796834d870202e81a5c68cd02ea275e2e0d5329283f1c336faa33551c046813c5c0221bede896e670e530c473e8357fb12cc4a35019e1e232a3daf3e2c98127395f3870060024923ac8518feb5e3583b22a45dd5ecc8bfe24b18d05892e574f6214bc9f83f03be627583835b538ab0e8abbc91563f3bfd53627490ce43f1c213a24cd1947913fa3f6ee2bdee1936f6d0ca5edccee3846661a424d0f299f2804bd1f29b41cfecc0e1a695f75131306b940ec25048c74a0989eb3fcd107356ac6e489fe65c6834abe9db8dda7336b6a7598f95ceab8a604edd844737d034767ff06a9639a4329a73cefa3f0c4b2c1bd45691c36fec02797078bb779fd96a144e6d512307a3f0fb9756a399810343d85ca5bd4ba5916ee9870d414d06b59460f2aa6b05f1ca453e1adff892fd2813934ff5a74f7bf57610afbd96ef9d3267dd6ca4606521805d66ea13b716e509f3c7a526f425e810773359de8387e83ca7a72f1f4bdb889b932a16927444435dcf1ed7e7d92d775b3735d55bd37da1de34802b3de3a69a0665039dacf36ae7ab77c72b1e0b175b420d3014c74531cea64a409f4abe58b1fe63617e4e2b1e080d199acbe5c7893478258eaff4577c23ce58a2d875f409025d48a7b6d19fa10f7c93c09b4249ddbf2532e811f2e88e9209617bdf4ea3d7b9cad630c9d8608f793396e64df71aa2a75d4cc9f8a4e8c305c9d8fa9c09376300e2ea566248b1f0df66c6a58a13420b67661a63bef47ac3cdcd4a0341a05fa5c2adb3f616c88cad063ca6be4934554e0123a579ca744741c8b98ef0aa9560e5607c3d32aa5fe99b7494050d03cd7cff3db0f44fc344f37f4c68eeae2a23ee65fa0362c44568d60badbf87c006905d70d8db78c58c467229c5f65bd8340b6c179e62c887baba0d1fffa66c07597589ed5bfe17dccc69b716f0f98597d20acb46442993aadf88904d21c60a8cf26e31f927fbfa232c01b1a24fd72b60aae0880f1f5ee8366622bf8d59467e87c2a4cf22edc15aaeef72daec5f6c6ce92517315b259091d41bb32b0f5e1c93d94252377e3db5e0fe4d6737493665131ca48ac8ab9e1e95001fe72a5ef3d557b662c68b292d48290646747e4cdbac549db0c65f4a8206e3d04d6610e88e4c2fdbbd7e7823c9e238830fce89a519c2045d28ca91dc4c9c27d6c2100dece10a85b9972616d1fdba7f79cb3e8c1a967b67a5193d1eb53bb16e3fc99b04a16f6ecc2bac86b2784659b0d022e1380dbb93a04621069200e50e6b150298be475bd23f5f515d0820d4fab0dc35feded2e79b8505e3a932350cb7210e23cbdfc9a047cde835b5745b28ddb09baabf45fec82e2cd8fb42fb1129f44016471c9ae8b56603f6785e333b74d14667702e98c1f811dbe4366beb3c4b71761cfe3cbe85523c58e5ccc8ded7f000097739662ba942b75efcfe4d1570fbee11f7d1ea6467e2832e110dc0af161ae33ad19af3ca42138856e1ef43387c989ee3d57626270d1adfb60baead9a75c4a3399c96ebbfdfc5b1d6b779a7ae2017ce8ef8aa8250539efeedb31428e48308a28ef5dd4895780475a23b885a913643683cdfe7b2f08bd5d75d81a9287d6797ff7db863691f02d142dd1eceb0a454bb217d606a4ed2db0d73cb96470a739b6f16ac4183cf7f3aa91be1a4cba75dc6e05cc7dc98f69a46df0ed106f1cfd16725981482dded3785f846e2deec048282a17da7c5575dbc0c5018204764794e2b52752d1509146bb71aa6651defbff91dd9153c42ca479f9d81906645703c96434e4f334e10441308152f430ab908e828f8b067cce9df3f51eaeefd359c94b06da64f4ffdac682bc7d5e2ad8e163684a8c14a4e92fb47b11678249bcbcb10756444690bd2b212e7ac0a74c91c6c60f4924b44e0b61d14ea048d6c067707a6946222c83e0e28f7ff1672eeb1e8f20cfa163f05b5af853963f1ad2deb425842a90f59bfaf1b0942c3934b5801b60bdc098de90fafdfbd05391908c911fa247cf3a4cefc3445bddd106348e0ad3f3a3320156581286bcd20ad652573ba4b3fdc83e85f508c4f368c59f821509a16a7af57a7b26d64f7b9590b472264991c3ae163a616033709f6f1c43c2183f56f01b5ce1fa901d7ad0e4aeb04cc5d1bb55fed04abccb682d1d82b6e7f5e804a37a2108f03b7b2954f922b24870bbeb2491902f53a6a1a472c391246f0fb94cbe84c3e5e19dd7d3401170567dff9242564ccbe93144c4e3685bcd1f57dd969733fa2ff3585d362feab934f77bc18907446c6718a9a91a9cc6b1ba09ab4478842889e9f2cdc273b4a9426f020182eb0a591d741e73f478a59db5f086d7ac124c1e50d385340ede633aa076ed639b3781486b53ddd1cef74f7c3438cc6609674fbdd061616c02aa11c55f17c8ef180ce91534873c408f195bb2879f824ee844bf51646be0e104d1a3880ec43743e5e7f8592a05ce02fd85ba2964cd2f2cca2b1b3c44b70555291c1b0bf5cb7a9395ab121215f3511e9c730b014190a3335d333d5398036b31759bd6bcf48d1e23da5bbd07b26dcd0c9cf6c83ebc691cd8ec80b4ee9a907b1f79b971f48125ceebe2da5fa05eea0a79e0dee526452ef19c24a8181b616bbfe9039bd368416b17ee5991ae2f7864a0173c2b7b2582f80489397abe04e2482eebd3962d7487d24e254dd37740d8f31c2f8bfb8683c8c26f2156936212e23f77c8d3e017eda83ff6099c401080585a07fda3c0d1a5aef17528a5c7bbe10aa770caf22cf7165517424164139c2c19cb82ed1cacb88aa7459357eff5c821c2f10d0230b1251dc9a041203786c332b1dd2da80d16c491b6dea0613b50631121bf0ee1025987283cbca65840c88f6a76fb69cc09ca499ee8372bb069a87de0339e798ff999e28a7a6da3d0907aa9cfee125b91d094b0f90b124b824f41faaf52c3f49caf31b5ad91285aeba9c46e2374f893f3db1097784be2a506ab48750ec33fb482a759a01704cc4fd1614bdb7484f51cfbe9f37a3f629cd9eb92f6cc80a548b2de9b934f1dd02ca33c2be534563a42d76af82e7fc38a9a02866bc2997344b5050ee13141252e36cf1b9c4e03a683f3ce0be0a0ed4cc88a2efc5e0866b22e7eb3ba7d0f4c17584e4dda844ce83159d87547eb12c189cc787a1a9a98b0c331d1830c6a65f1e2a71a4faf76630db6d76df3b4f34560afa565ce5ece70cd02163a8ad1e41729b737568d63ede226fc1d4c6406a12d96f259fc74d3dc1fddc3c86567be082eea4375c75c2814ede426b4aa2a0a61de09399b8306106939ae561aed0bfd95e938f5f14d4943594d745f7299ce6d181777875b8fc15b98937d49866dcdc5146dfb989ed1f7d7d01dd511993206d337e84d7a6eb3546088f4db0c8e598a58d5389baa48040b9dca952df7d91a9c1a74c5f58120beea73084e5ea4952be486ceccd49f474d2619a2c5e1518ac1231fc6129333db80fe66a6dcccc1c3d4b00304e832118146239671b8dd6bf4182f0ac41ba14c712082aeb85dc0204dfe376c560e03c822764f30cd88f257ff7470fd846fb0c63bfec8bdd7edd8e8cc9fd6b4cb39832f9a04ccde3fc91d7a307978d6aa5241d36e7b2b464a0541baf11e884b28326a41c5be947f3efa74dafb5826f2f8985d8b6400cae9c4562f1d2ba4ea64c0938e64cd1bac34aec5c94ffae00dc1070ab2a24925627b99f13e989f5becddcc091da6c92ea9c2d06cb298fbf9ea20e8738506323209a461b293b37ec99e5a197ec220d923efe2c1c4d19a925bef163a9b6a077f2c1a004fb7902f8af2c3049aa5b3ec599bc396d8bf0aa38d08c039ce690e10fcf3fa7d0ebab390d0bb7d721c216146dd6cb912c0059bba5c159e6429b2520ccdd06e3d1968ad5559a1f59c5623c3bd411830d4db9751d998235efe946d66c6214261684df3d18084bbd6a18777e94a014ad2ab16fedd645b152cbbc8e800a88c1b4b809e3',
        salt = '93a4820a447ac54f34bd1c7195594573',
        labelError = 'Bad password!',
        isRememberEnabled = false,
        rememberDurationInDays = 0; // 0 means forever

    // constants
    const rememberPassphraseKey = 'staticrypt_passphrase',
        rememberExpirationKey = 'staticrypt_expiration';

    /**
     * Decrypt our encrypted page, replace the whole HTML.
     *
     * @param  hashedPassphrase
     * @returns {Promise<boolean>}
     */
    async function decryptAndReplaceHtml(hashedPassphrase) {
        const result = await decode(encryptedMsg, hashedPassphrase, salt);
        if (!result.success) {
            return false;
        }
        const plainHTML = result.decoded;

        document.write(plainHTML);
        document.close();
        return true;
    }

    /**
     * Clear localstorage from staticrypt related values
     */
    function clearLocalStorage() {
        localStorage.removeItem(rememberPassphraseKey);
        localStorage.removeItem(rememberExpirationKey);
    }

    /**
     * Clear storage if we are logging out
     *
     * @returns  - whether we logged out
     */
    function logoutIfNeeded() {
        const logoutKey = "staticrypt_logout";

        // handle logout through query param
        const queryParams = new URLSearchParams(window.location.search);
        if (queryParams.has(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        // handle logout through URL fragment
        const hash = window.location.hash.substring(1);
        if (hash.includes(logoutKey)) {
            clearLocalStorage();
            return true;
        }

        return false;
    }

    /**
     * To be called on load: check if we want to try to decrypt and replace the HTML with the decrypted content, and
     * try to do it if needed.
     *
     * @returns {Promise<boolean>} true if we derypted and replaced the whole page, false otherwise
     */
    async function decryptOnLoadFromRememberMe() {
        if (!isRememberEnabled) {
            return false;
        }

        // show the remember me checkbox
        document.getElementById('staticrypt-remember-label').classList.remove('hidden');

        // if we are login out, terminate
        if (logoutIfNeeded()) {
            return false;
        }

        // if there is expiration configured, check if we're not beyond the expiration
        if (rememberDurationInDays && rememberDurationInDays > 0) {
            const expiration = localStorage.getItem(rememberExpirationKey),
                isExpired = expiration && new Date().getTime() > parseInt(expiration);

            if (isExpired) {
                clearLocalStorage();
                return false;
            }
        }

        const hashedPassphrase = localStorage.getItem(rememberPassphraseKey);

        if (hashedPassphrase) {
            // try to decrypt
            const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassphrase);

            // if the decryption is unsuccessful the password might be wrong - silently clear the saved data and let
            // the user fill the password form again
            if (!isDecryptionSuccessful) {
                clearLocalStorage();
                return false;
            }

            return true;
        }

        return false;
    }

    function decryptOnLoadFromUrl() {
        const passwordKey = "staticrypt_pwd";

        // get the password from the query param
        const queryParams = new URLSearchParams(window.location.search);
        const hashedPassphraseQuery = queryParams.get(passwordKey);

        // get the password from the url fragment
        const hashRegexMatch = window.location.hash.substring(1).match(new RegExp(passwordKey + "=(.*)"));
        const hashedPassphraseFragment = hashRegexMatch ? hashRegexMatch[1] : null;

        const hashedPassphrase = hashedPassphraseFragment || hashedPassphraseQuery;

        if (hashedPassphrase) {
            return decryptAndReplaceHtml(hashedPassphrase);
        }

        return false;
    }

    // try to automatically decrypt on load if there is a saved password
    window.onload = async function () {
        let hasDecrypted = await decryptOnLoadFromUrl();

        if (!hasDecrypted) {
            hasDecrypted = await decryptOnLoadFromRememberMe();
        }

        // if we didn't decrypt anything, show the password prompt. Otherwise the content has already been replaced, no
        // need to do anything
        if (!hasDecrypted) {
            document.getElementById("staticrypt_loading").classList.add("hidden");
            document.getElementById("staticrypt_content").classList.remove("hidden");
            document.getElementById("staticrypt-password").focus();
        }
    }

    // handle password form submission
    document.getElementById('staticrypt-form').addEventListener('submit', async function (e) {
        e.preventDefault();

        const passphrase = document.getElementById('staticrypt-password').value,
            shouldRememberPassphrase = document.getElementById('staticrypt-remember').checked;

        // decrypt and replace the whole page
        const hashedPassphrase = await cryptoEngine.hashPassphrase(passphrase, salt);
        const isDecryptionSuccessful = await decryptAndReplaceHtml(hashedPassphrase);

        if (isDecryptionSuccessful) {
            // remember the hashedPassphrase and set its expiration if necessary
            if (isRememberEnabled && shouldRememberPassphrase) {
                window.localStorage.setItem(rememberPassphraseKey, hashedPassphrase);

                // set the expiration if the duration isn't 0 (meaning no expiration)
                if (rememberDurationInDays > 0) {
                    window.localStorage.setItem(
                        rememberExpirationKey,
                        (new Date().getTime() + rememberDurationInDays * 24 * 60 * 60 * 1000).toString()
                    );
                }
            }
        } else {
            alert(labelError);
        }
    });
</script>
</body>
</html>
